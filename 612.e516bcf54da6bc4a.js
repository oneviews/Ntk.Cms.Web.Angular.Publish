"use strict";(self.webpackChunkntk_cms_web=self.webpackChunkntk_cms_web||[]).push([[612],{532:(R,f,s)=>{s.d(f,{t:()=>o});var o=(()=>{return(e=o||(o={}))[e.none=0]="none",e[e.add=1]="add",e[e.edit=2]="edit",e[e.delete=3]="delete",e[e.list=4]="list",e[e.select=5]="select",o;var e})()},6609:(R,f,s)=>{s.d(f,{D:()=>l});var o=s(8239),e=s(9724),c=s(7977),u=s(1659),D=s(1927),T=s(3151),A=s(2147),O=s(1528),E=s(7969),v=s(656),m=s(4817),g=s(5691),P=s(8904),C=s(5821),M=s(1048),I=s(1531),S=s(4848),L=s(1418);function K(a,n){if(1&a&&(e._UZ(0,"img",8),e.ALo(1,"cmsthumbnail")),2&a){const t=e.oxw().$implicit;e.s9C("src",e.lcZ(1,1,t.linkImageIdSrc),e.LSH)}}function y(a,n){if(1&a&&(e.TgZ(0,"mat-option",6),e.YNc(1,K,2,3,"img",7),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&a){const t=n.$implicit,i=e.oxw();e.Q6J("value",t)("disabled",i.optionDisabled),e.xp6(1),e.Q6J("ngIf",t.linkImageIdSrc),e.xp6(2),e.Oqu(i.displayOption(t))}}function _(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mat-icon",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().onActionSelectClear()}),e._uU(1,"close"),e.qZA()}}const d=["*"];let l=(()=>{class a{constructor(t,i,p,h){this.coreEnumService=t,this.translate=i,this.cdr=p,this.categoryService=h,this.dataModelResult=new c.y$4,this.dataModelSelect=new c.Dp$,this.loading=new v.O,this.formControl=new u.NI,this.optionDisabled=!1,this.optionSelectFirstItem=!1,this.optionPlaceholder="",this.optionChange=new e.vpe,this.optionReload=()=>this.onActionReload(),this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information")}set optionSelectForce(t){this.onActionSelectForce(t)}ngOnInit(){this.filteredOptions=this.formControl.valueChanges.pipe((0,D.O)(""),(0,T.b)(1e3),(0,A.x)(),(0,O.w)(t=>this.DataGetAll("string"==typeof t||"number"==typeof t?t:"")))}displayFn(t){return t&&t.virtual_Parent&&t.virtual_Parent.title.length>0?t.virtual_Parent.titleML+" > "+t.titleML:t?t.titleML:void 0}displayOption(t){return t&&t.virtual_Parent&&t.virtual_Parent.title.length>0?t.virtual_Parent.titleML+" > "+t.titleML:t?t.titleML:void 0}DataGetAll(t){var i=this;return(0,o.Z)(function*(){const p=new c.Hay;if(p.rowPerPage=20,p.accessLoad=!0,t&&t.length>0){let r=new c.AO3;r=new c.AO3,r.propertyName="Symbol",r.value=t,r.searchType=c.b3P.Contains,r.clauseType=c.KT6.Or,p.filters.push(r),r=new c.AO3,r.propertyName="Title",r.value=t,r.searchType=c.b3P.Contains,r.clauseType=c.KT6.Or,p.filters.push(r),t&&"number"==typeof+t&&+t>0&&(r=new c.AO3,r.propertyName="Id",r.value=t,r.searchType=c.b3P.Equal,r.clauseType=c.KT6.Or,p.filters.push(r))}const h=i.constructor.name+"main";return i.loading.Start(h),yield i.categoryService.ServiceGetAll(p).pipe((0,E.U)(r=>(i.dataModelResult=r,i.optionSelectFirstItem&&(!i.dataModelSelect||!i.dataModelSelect.id||i.dataModelSelect.id<=0)&&i.dataModelResult.listItems.length>0&&(i.optionSelectFirstItem=!1,setTimeout(()=>{i.formControl.setValue(i.dataModelResult.listItems[0])},1e3),i.onActionSelect(i.dataModelResult.listItems[0])),i.loading.Stop(h),r.listItems))).toPromise()})()}onActionSelect(t){this.optionDisabled||(this.dataModelSelect=t,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.formControl.setValue(null),this.optionChange.emit(null))}push(t){return this.filteredOptions.pipe((0,E.U)(i=>(i.find(p=>p.id===t.id)||i.push(t),i)))}onActionSelectForce(t){if("number"==typeof t&&t>0){if(this.dataModelSelect&&this.dataModelSelect.id===t)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===t)){const i=this.dataModelResult.listItems.find(p=>p.id===t);return this.dataModelSelect=i,void this.formControl.setValue(i)}this.categoryService.ServiceGetOneById(t).subscribe(i=>{i.isSuccess&&(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item))})}else{if(typeof t==typeof c.Dp$)return this.filteredOptions=this.push(t),this.dataModelSelect=t,void this.formControl.setValue(t);this.formControl.setValue(null)}}onActionReload(){this.dataModelSelect=new c.Dp$,this.DataGetAll(null)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(c.FLW),e.Y36(m.sK),e.Y36(e.sBO),e.Y36(c.XRW))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-cms-location-selector"]],inputs:{loading:"loading",optionDisabled:"optionDisabled",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},ngContentSelectors:d,decls:8,vars:9,consts:[[1,"ntk-full-width"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto34","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[3,"value","disabled"],["style","vertical-align:middle;","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(t,i){if(1&t&&(e.F$t(),e.TgZ(0,"mat-form-field",0),e._UZ(1,"input",1),e.TgZ(2,"mat-autocomplete",2,3),e.NdJ("optionSelected",function(h){return i.onActionSelect(h.option.value)}),e.YNc(4,y,4,4,"mat-option",4),e.ALo(5,"async"),e.qZA(),e.YNc(6,_,2,0,"mat-icon",5),e.Hsn(7),e.qZA()),2&t){const p=e.MAs(3);e.xp6(1),e.s9C("placeholder",i.optionPlaceholder),e.Q6J("formControl",i.formControl)("matAutocomplete",p),e.uIk("disabled",!!i.optionDisabled||null),e.xp6(1),e.Q6J("displayWith",i.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(5,7,i.filteredOptions)),e.xp6(2),e.Q6J("ngIf",i.dataModelSelect.id)}},directives:[g.KE,P.Nt,u.Fj,C.ZL,u.JJ,u.oH,C.XC,M.sg,I.ey,M.O5,S.Hw,g.R9],pipes:[M.Ov,L.v],encapsulation:2}),a})()},9831:(R,f,s)=>{s.d(f,{u:()=>y});var o=s(9724),e=s(7977),c=s(4482),u=s(1659),D=s(1927),T=s(3151),A=s(1528),O=s(7969),E=s(2607),v=s(5691),m=s(6405),g=s(1048),P=s(4848),C=s(5821),M=s(1531);const I=["tagInput"];function S(_,d){if(1&_){const l=o.EpF();o.TgZ(0,"mat-chip",9),o.NdJ("removed",function(){const t=o.CHM(l).$implicit;return o.oxw().remove(t)}),o._uU(1),o.TgZ(2,"button",10)(3,"mat-icon"),o._uU(4,"cancel"),o.qZA()()()}if(2&_){const l=d.$implicit;o.xp6(1),o.hij(" ",l.display," ")}}function L(_,d){if(1&_&&(o.TgZ(0,"mat-option",11),o._uU(1),o.qZA()),2&_){const l=d.$implicit;o.Q6J("value",l),o.xp6(1),o.hij(" ",l.display," ")}}let y=(()=>{class _{constructor(l,a){this.service=l,this.cmsToastrService=a,this.optionDisabled=!1,this.optionPlaceholder="+ Tag",this.optionLabel=" Select",this.optionChange=new o.vpe,this.tagDataModel=[],this.tagLastDataModel=[],this.selectForceStatus=!0,this.separatorKeysCodes=[c.K5,c.OC],this.tagCtrl=new u.NI(""),this.addOnBlur=!0,this.filteredOptions=this.tagCtrl.valueChanges.pipe((0,D.O)(null),(0,T.b)(400),(0,A.w)(n=>this.filter(n||"")))}set optionSelectForce(l){this.onActionSelectForce(l)}ngOnInit(){}filter(l){const a=new e.Hay;a.rowPerPage=20,a.accessLoad=!0;let n=new e.AO3;return n.propertyName="Title",n.value=l,n.searchType=e.b3P.Contains,n.clauseType=e.KT6.Or,a.filters.push(n),l&&"number"==typeof+l&&+l>0&&(n=new e.AO3,n.propertyName="Id",n.value=l,n.searchType=e.b3P.Equal,n.clauseType=e.KT6.Or,a.filters.push(n)),this.service.ServiceGetAll(a).pipe((0,O.U)(t=>(this.tagLastDataModel=t.listItems.map(i=>({display:i.title,value:i.id})),this.tagLastDataModel)))}checkIndex(l){var a=0,n=-1;return this.tagDataModel.forEach(t=>{t.value==l&&(n=a),a++}),n}add(l){var a;l.value&&this.tagLastDataModel.forEach(n=>{(n.display==l.value||n.value+""==l.value)&&(a=n)}),a&&this.checkIndex(a.value)<0&&(this.tagDataModel.push(a),this.onActionChange()),l.chipInput.clear(),this.tagCtrl.setValue(null)}remove(l){const a=this.checkIndex(l.value);a>=0&&(this.tagDataModel.splice(a,1),this.onActionChange())}selected(l){const a=l.option.value;this.checkIndex(a.value)<0&&this.tagDataModel.push(a),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null),this.onActionChange()}onActionChange(){const l=[];this.tagDataModel.forEach(a=>{l.push(a.value)}),this.selectForceStatus=!1,this.optionChange.emit(l)}onActionSelectForce(l){if(!this.selectForceStatus||!l||0===l.length)return;const a=new e.Hay;l.forEach(n=>{if(n>0){const t=new e.AO3;t.propertyName="Id",t.value=n,t.clauseType=e.KT6.Or,a.filters.push(t)}}),this.service.ServiceGetAll(a).pipe((0,O.U)(n=>{n.isSuccess?n.listItems.forEach(t=>{this.tagDataModel.push({value:t.id,display:t.title})}):this.cmsToastrService.typeErrorGetAll(n.errorMessage)},n=>{this.cmsToastrService.typeErrorGetAll(n)})).toPromise()}}return _.\u0275fac=function(l){return new(l||_)(o.Y36(e.dF2),o.Y36(E.e))},_.\u0275cmp=o.Xpm({type:_,selectors:[["app-cms-tag-autocomplete"]],viewQuery:function(l,a){if(1&l&&o.Gf(I,5),2&l){let n;o.iGM(n=o.CRH())&&(a.tagInput=n.first)}},inputs:{optionDisabled:"optionDisabled",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},decls:12,vars:12,consts:[["appearance","fill",2,"width","100%"],["aria-label","tag selection",3,"disabled"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],[3,"placeholder","matChipInputAddOnBlur","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(l,a){if(1&l&&(o.TgZ(0,"mat-form-field",0)(1,"mat-label"),o._uU(2),o.qZA(),o.TgZ(3,"mat-chip-list",1,2),o.YNc(5,S,5,1,"mat-chip",3),o.TgZ(6,"input",4,5),o.NdJ("matChipInputTokenEnd",function(t){return a.add(t)}),o.qZA()(),o.TgZ(8,"mat-autocomplete",6,7),o.NdJ("optionSelected",function(t){return a.selected(t)}),o.YNc(10,L,2,2,"mat-option",8),o.ALo(11,"async"),o.qZA()()),2&l){const n=o.MAs(4),t=o.MAs(9);o.xp6(2),o.Oqu(a.optionLabel),o.xp6(1),o.Q6J("disabled",a.optionDisabled),o.xp6(2),o.Q6J("ngForOf",a.tagDataModel),o.xp6(1),o.Q6J("placeholder",a.optionPlaceholder)("matChipInputAddOnBlur",a.addOnBlur)("formControl",a.tagCtrl)("matAutocomplete",t)("matChipInputFor",n)("matChipInputSeparatorKeyCodes",a.separatorKeysCodes),o.xp6(4),o.Q6J("ngForOf",o.lcZ(11,10,a.filteredOptions))}},directives:[v.KE,v.hX,m.qn,g.sg,m.HS,m.qH,P.Hw,u.Fj,C.ZL,m.oH,u.JJ,u.oH,C.XC,M.ey],pipes:[g.Ov],encapsulation:2}),_})()}}]);