"use strict";(self.webpackChunkntk_cms_web=self.webpackChunkntk_cms_web||[]).push([[4705],{4705:(be,Z,i)=>{i.r(Z),i.d(Z,{SmsActionModule:()=>xe});var C=i(1048),v=i(7076),x=i(8239),l=i(7977),S=i(656),e=i(9724),T=i(2607),E=i(3029),_=i(4817),r=i(1659),J=i(5738),b=i(4311),w=i(8024),D=i(8161),O=i(600),P=i(1927),U=i(3151),B=i(2147),L=i(1528),I=i(7969),u=i(5691),N=i(8904),F=i(5821),Q=i(1531),A=i(4848);function R(n,c){if(1&n&&(e.TgZ(0,"mat-option",6)(1,"span"),e._uU(2),e.qZA()()),2&n){const t=c.$implicit,o=e.oxw();e.Q6J("value",t)("disabled",o.optionDisabled),e.xp6(2),e.Oqu(o.displayOption(t))}}function Y(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"mat-icon",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().onActionSelectClear()}),e._uU(1,"close"),e.qZA()}}const H=["*"];let G=(()=>{class n{constructor(t,o,a,s,d){this.coreEnumService=t,this.cmsToastrService=o,this.cdr=a,this.translate=s,this.categoryService=d,this.dataModelResult=new l.y$4,this.dataModelSelect=new l.Lnx,this.loading=new S.O,this.formControl=new r.NI,this.optionPlaceholder="",this.optionSelectFirstItem=!1,this.optionChange=new e.vpe,this.optionReload=()=>this.onActionReload(),this.optionDisabled=!1,this.privateLinkCategryId="",this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information")}set optionSelectForce(t){this.onActionSelectForce(t)}set optionLinkCategryId(t){t!=this.privateLinkCategryId&&(""!=this.privateLinkCategryId&&this.onActionSelectClear(),this.privateLinkCategryId=t,this.loadOptions())}ngOnInit(){this.loadOptions()}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe((0,P.O)(""),(0,U.b)(1500),(0,B.x)(),(0,L.w)(t=>"string"==typeof t||"number"==typeof t?this.DataGetAll(t||""):[]))}displayFn(t){return t?t.title:void 0}displayOption(t){return t?t.title:void 0}DataGetAll(t){var o=this;return(0,x.Z)(function*(){const a=new l.Hay;a.rowPerPage=20,a.accessLoad=!0;let s=new l.AO3;s.propertyName="Title",s.value=t,s.searchType=l.b3P.Contains,s.clauseType=l.KT6.Or,a.filters.push(s),t&&"string"==typeof+t&&+t>0&&(s=new l.AO3,s.propertyName="Id",s.value=t,s.searchType=l.b3P.Equal,s.clauseType=l.KT6.Or,a.filters.push(s)),o.privateLinkCategryId&&o.privateLinkCategryId.length>0&&(s=new l.AO3,s.propertyName="linkCategoryId",s.value=o.privateLinkCategryId,s.searchType=l.b3P.Equal,a.filters.push(s));const d=o.constructor.name+"main";return o.loading.Start(d),yield o.categoryService.ServiceGetAll(a).pipe((0,I.U)(h=>(o.dataModelResult=h,o.optionSelectFirstItem&&(!o.dataModelSelect||!o.dataModelSelect.id||0==o.dataModelSelect.id.length)&&o.dataModelResult.listItems.length>0&&(o.optionSelectFirstItem=!1,setTimeout(()=>{o.formControl.setValue(o.dataModelResult.listItems[0]),o.onActionSelect(o.dataModelResult.listItems[0])},1e3)),o.loading.Stop(d),h.listItems))).toPromise()})()}onActionSelect(t){this.dataModelSelect=t,this.optionChange.emit(this.dataModelSelect)}onActionSelectClear(){this.formControl.setValue(null),this.optionChange.emit(null)}push(t){return this.filteredOptions.pipe((0,I.U)(o=>(o.find(a=>a.id===t.id)||o.push(t),o)))}onActionSelectForce(t){if("string"==typeof t&&t.length>0){if(this.dataModelSelect&&this.dataModelSelect.id===t)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(o=>o.id===t)){const o=this.dataModelResult.listItems.find(a=>a.id===t);return this.dataModelSelect=o,void this.formControl.setValue(o)}this.categoryService.ServiceGetOneById(t).subscribe({next:o=>{o.isSuccess?(this.filteredOptions=this.push(o.item),this.dataModelSelect=o.item,this.formControl.setValue(o.item),this.optionChange.emit(o.item)):this.cmsToastrService.typeErrorMessage(o.errorMessage)}})}else{if(typeof t==typeof l.Lnx)return this.filteredOptions=this.push(t),this.dataModelSelect=t,void this.formControl.setValue(t);this.formControl.setValue(null)}}onActionReload(){this.dataModelSelect=new l.Lnx,this.DataGetAll(null)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.FLW),e.Y36(T.e),e.Y36(e.sBO),e.Y36(_.sK),e.Y36(l.ULy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-sms-main-message-content-selector"]],inputs:{loading:"loading",optionPlaceholder:"optionPlaceholder",optionSelectFirstItem:"optionSelectFirstItem",optionReload:"optionReload",optionSelectForce:"optionSelectForce",optionLinkCategryId:"optionLinkCategryId",optionDisabled:"optionDisabled"},outputs:{optionChange:"optionChange"},ngContentSelectors:H,decls:8,vars:8,consts:[[1,"ntk-full-width"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto27","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[3,"value","disabled"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(t,o){if(1&t&&(e.F$t(),e.TgZ(0,"mat-form-field",0),e._UZ(1,"input",1),e.TgZ(2,"mat-autocomplete",2,3),e.NdJ("optionSelected",function(s){return o.onActionSelect(s.option.value)}),e.YNc(4,R,3,3,"mat-option",4),e.ALo(5,"async"),e.qZA(),e.YNc(6,Y,2,0,"mat-icon",5),e.Hsn(7),e.qZA()),2&t){const a=e.MAs(3);e.xp6(1),e.s9C("placeholder",o.optionPlaceholder),e.Q6J("formControl",o.formControl)("matAutocomplete",a),e.xp6(1),e.Q6J("displayWith",o.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(5,6,o.filteredOptions)),e.xp6(2),e.Q6J("ngIf",o.dataModelSelect.id)}},directives:[u.KE,N.Nt,r.Fj,F.ZL,r.JJ,r.oH,F.XC,C.sg,Q.ey,C.O5,A.Hw,u.R9],pipes:[C.Ov],encapsulation:2}),n})();var q=i(4405),g=i(4187),j=i(9252),W=i(8485),X=i(727),$=i(3472),K=i(6088);function V(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"mat-tree-node",6),e._UZ(1,"button",7),e.TgZ(2,"mat-checkbox",8),e.NdJ("change",function(){const s=e.CHM(t).$implicit;return e.oxw().checklistSelection.toggle(s)}),e._uU(3),e.qZA()()}if(2&n){const t=c.$implicit,o=e.oxw();e.xp6(2),e.Q6J("checked",o.checklistSelection.isSelected(t)),e.xp6(1),e.Oqu(t.title)}}function z(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"mat-nested-tree-node")(1,"li")(2,"div",9)(3,"button",10)(4,"mat-icon",11),e._uU(5),e.qZA()(),e.TgZ(6,"mat-checkbox",12),e.NdJ("change",function(){const s=e.CHM(t).$implicit;return e.oxw().todoItemSelectionToggle(s)}),e._uU(7),e.qZA()(),e.TgZ(8,"ul"),e.GkF(9,13),e.qZA()()()}if(2&n){const t=c.$implicit,o=e.oxw();e.xp6(3),e.uIk("aria-label","Toggle "+t.title),e.xp6(2),e.hij(" ",o.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),e.xp6(1),e.Q6J("checked",o.checklistSelection.isSelected(t))("indeterminate",o.descendantsPartiallySelected(t)),e.xp6(1),e.hij(" ",t.title,""),e.xp6(1),e.ekj("category-tree-invisible",!o.treeControl.isExpanded(t))}}let ee=(()=>{class n{constructor(t,o,a,s,d,h,f){this.cmsToastrService=t,this.coreEnumService=o,this.categoryService=a,this.cdr=s,this.dialog=d,this.translate=h,this.tokenHelper=f,this.dataModelSelect=[],this.dataModelResult=new l.y$4,this.filteModel=new l.Hay,this.loading=new S.O,this.treeControl=new q.VY(m=>m.children),this.dataSource=new g.WX,this.runComplate=!1,this.optionSelectChecked=new e.vpe,this.optionSelectDisChecked=new e.vpe,this.optionModelChange=new e.vpe,this.checklistSelection=new j.Ov(!0),this.hasChild=(m,p)=>!!p.children&&p.children.length>0,this.hasNoContent=(m,p)=>p.children,this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information"),this.checklistSelection.changed.subscribe(m=>{if(!this.runComplate)return;const p=[];this.checklistSelection.selected.forEach(M=>{p.push(M.id)}),this.optionModelChange.emit(p),m.added&&m.added.length>0&&m.added.forEach(M=>{this.optionSelectChecked.emit(M.id)}),m.removed&&m.removed.length>0&&m.removed.forEach(M=>{this.optionSelectDisChecked.emit(M.id)})})}set optionModel(t){this.dataModelSelect=t,this.loadCheked()}ngOnInit(){this.DataGetAll(),this.cmsApiStoreSubscribe=this.tokenHelper.getCurrentTokenOnChange().subscribe(t=>{this.DataGetAll()})}ngOnDestroy(){this.cmsApiStoreSubscribe.unsubscribe()}loadCheked(t=this.treeControl.dataNodes){this.runComplate=!1,this.treeControl.dataNodes&&this.dataModelSelect&&this.dataModelSelect.length>0&&t.forEach(o=>{this.dataModelSelect.find(s=>s===o.id)&&this.checklistSelection.select(o),o.children&&o.children.length>0&&this.loadCheked(o.children)}),this.runComplate=!0}DataGetAll(){this.filteModel.rowPerPage=200,this.filteModel.accessLoad=!0;const t=this.constructor.name+"main";this.loading.Start(t),this.categoryService.ServiceGetAll(this.filteModel).subscribe({next:o=>{o.isSuccess?(this.dataModelResult=o,this.dataSource.data=this.dataModelResult.listItems,this.treeControl.dataNodes=this.dataModelResult.listItems,this.loadCheked()):this.cmsToastrService.typeErrorMessage(o.errorMessage),this.loading.Stop(t)},error:o=>{this.loading.Stop(t),this.cmsToastrService.typeError(o)}})}descendantsAllSelected(t){return this.treeControl.getDescendants(t).every(a=>this.checklistSelection.isSelected(a))}descendantsPartiallySelected(t){return this.treeControl.getDescendants(t).some(s=>this.checklistSelection.isSelected(s))&&!this.descendantsAllSelected(t)}todoItemSelectionToggle(t){this.checklistSelection.toggle(t);const o=this.treeControl.getDescendants(t);this.checklistSelection.isSelected(t)?this.checklistSelection.select(...o):this.checklistSelection.deselect(...o)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T.e),e.Y36(l.FLW),e.Y36(l.buc),e.Y36(e.sBO),e.Y36(W.uw),e.Y36(_.sK),e.Y36(X.v))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-cms-contact-category-tree-selector"]],inputs:{optionModel:"optionModel"},outputs:{optionSelectChecked:"optionSelectChecked",optionSelectDisChecked:"optionSelectDisChecked",optionModelChange:"optionModelChange"},decls:6,vars:3,consts:[[1,"ntk-cms-html-tree-header"],[1,"ntk-cms-html-tree-body"],[1,"category-tree","cursor-pointer",3,"dataSource","treeControl"],["matTreeNodePadding","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"ntk-cms-html-tree-footer"],["matTreeNodePadding",""],["type","button","mat-icon-button","","disabled",""],[1,"checklist-leaf-node",3,"checked","change"],[1,"mat-tree-node"],["type","button","mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],[3,"checked","indeterminate","change"],["matTreeNodeOutlet",""]],template:function(t,o){1&t&&(e._UZ(0,"div",0),e.TgZ(1,"div",1)(2,"mat-tree",2),e.YNc(3,V,4,2,"mat-tree-node",3),e.YNc(4,z,10,7,"mat-nested-tree-node",4),e.qZA()(),e._UZ(5,"div",5)),2&t&&(e.xp6(2),e.Q6J("dataSource",o.dataSource)("treeControl",o.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",o.hasChild))},directives:[g.gi,g.fQ,g.uo,g.ah,$.lW,K.oG,g.GZ,g.eu,A.Hw,g.Ar],encapsulation:2}),n})();var k=i(38),te=i(8543),y=i(558),oe=i(1582),ne=i(2370),ae=i(2022);const se=["vform"];function ie(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"app-sms-api-number-selector",46),e.NdJ("optionChange",function(a){return e.CHM(t),e.oxw().onActionSelectApiNumber(a)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("loading",t.loading)("optionLinkApiPathId",t.dataModel.linkApiPathId)("optionPlaceholder"," \u0634\u0645\u0627\u0631\u0647 \u0641\u0631\u0633\u062a\u0646\u062f\u0647")("optionSelectFirstItem",!0)}}function le(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"textarea",47),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().dataMessageContentModel.messageBody=a}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ngModel",t.dataMessageContentModel.messageBody)}}function ce(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().onActionMessageContentAdd()}),e._UZ(1,"i",49),e._uU(2," \u0627\u0636\u0627\u0641\u0647 \u0628\u0647 \u0645\u062a\u0646 "),e.qZA()}}function de(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().onActionMessageContentNew()}),e._UZ(1,"i",49),e._uU(2," \u0645\u062a\u0646 \u067e\u06cc\u0627\u0645 "),e.qZA()}}function re(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"mat-icon",50),e.NdJ("click",function(){return e.CHM(t),e.oxw().onActionMessageContentNew()}),e._uU(1,"close"),e.qZA()}}function me(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"mat-icon",50),e.NdJ("click",function(){return e.CHM(t),e.oxw().dataModel.message=""}),e._uU(1,"close"),e.qZA()}}function ue(n,c){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," \u0645\u062a\u0646 \u067e\u06cc\u0627\u0645 "),e.TgZ(2,"strong"),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"MESSAGE.required")))}function ge(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"mat-icon",50),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).dataModel.toNumbers=""}),e._uU(1,"close"),e.qZA()}}function pe(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",19)(1,"mat-label"),e._uU(2,"\u0634\u0645\u0627\u0631\u0647 \u06af\u06cc\u0631\u0646\u062f\u0647"),e.qZA(),e.TgZ(3,"textarea",51,52),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().dataModel.toNumbers=a}),e.qZA(),e.YNc(5,ge,2,0,"mat-icon",21),e.TgZ(6,"mat-icon",35),e._uU(7,"mode_edit"),e.qZA(),e.TgZ(8,"mat-hint",53)(9,"mat-icon",54),e._uU(10,"info"),e.qZA(),e.TgZ(11,"strong",55),e._uU(12,"\u0634\u0645\u0627\u0631\u0647 \u06af\u06cc\u0631\u0646\u062f\u0647 \u067e\u06cc\u0627\u0645 \u0631\u0627 \u0645\u06cc \u062a\u0648\u0627\u0646\u06cc\u062f \u0628\u0627 \u06a9\u0627\u0645\u0627 \u0627\u0632 \u0647\u0645 \u062c\u062f\u0627 \u06a9\u0646\u06cc\u062f"),e.qZA()(),e.TgZ(13,"mat-hint",36),e._uU(14),e.qZA()()}if(2&n){const t=e.MAs(4),o=e.oxw();e.xp6(3),e.Q6J("ngModel",o.dataModel.toNumbers),e.xp6(2),e.Q6J("ngIf",o.dataModel.toNumbers),e.xp6(9),e.hij("",t.value.length," / 500")}}function he(n,c){if(1&n&&e._UZ(0,"app-cms-json-list",56),2&n){const t=e.oxw();e.Q6J("dataModel",t.dataModelResult.item)("optionMethod",1)}}function Ce(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).onFormSubmit()}),e._UZ(1,"i",59),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&n){e.oxw(2);const t=e.MAs(1);e.Q6J("disabled",!t.valid),e.xp6(2),e.hij(" ",e.lcZ(3,2,"ACTION.Send_Message")," ")}}function fe(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",41)(1,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().onFormCancel()}),e._UZ(2,"i",49),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,Ce,4,4,"button",57),e.qZA()}if(2&n){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,2,"ACTION.CANCEL")," "),e.xp6(2),e.Q6J("ngIf",!t.loading.display)}}class Me{}const Se=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-sms-action"]],decls:1,vars:0,template:function(t,o){1&t&&e._UZ(0,"router-outlet")},directives:[v.lC],encapsulation:2}),n})(),children:[{path:"send-message",component:(()=>{class n{constructor(t,o,a,s,d,h){var f;this.coreEnumService=t,this.smsMainApiPathService=o,this.cmsToastrService=a,this.cdr=s,this.publicHelper=d,this.translate=h,this.requestLinkApiPathId="",this.loading=new S.O,this.loadingAction=new S.O,this.dataModelParentSelected=new l.lWT,this.dataModel=new l.sh1,this.dataModelResult=new l.y$4,this.dataModelDateByClock=new Me,this.formInfo=new l.LEF,this.clipboardText="",this.dataMessageCategoryModel=new l._fd,this.dataMessageContentModel=new l.Lnx,this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information"),this.loadingAction.cdr=this.cdr,(null===(f=this.requestLinkApiPathId)||void 0===f?void 0:f.length)>0&&(this.dataModel.linkApiPathId=this.requestLinkApiPathId)}ngOnInit(){this.onActionScheduleSendNow()}onActionScheduleSendNow(){const t=new Date;this.dataModel.scheduleSend=t,this.dataModelDateByClock.clock=t.getHours()+":"+t.getMinutes(),this.dataModelDateByClock.date=t}onActionScheduleSendCheck(){const t=new Date;this.dataModelDateByClock.clock||(this.dataModelDateByClock.clock=t.getHours()+":"+t.getMinutes()),this.dataModelDateByClock.date||(this.dataModelDateByClock.date=t),this.dataModelDateByClock.date=new Date(this.dataModelDateByClock.date),this.dataModelDateByClock.date.setHours(0|+this.dataModelDateByClock.clock.split(":")[0],0|+this.dataModelDateByClock.clock.split(":")[1]),this.dataModel.scheduleSend=this.dataModelDateByClock.date}readClipboardFromDevTools(){return new Promise((t,o)=>{const a=function(){var s=(0,x.Z)(function*(){try{const d=yield navigator.clipboard.readText();t(d)}catch(d){o(d)}window.removeEventListener("focus",a)});return function(){return s.apply(this,arguments)}}();window.addEventListener("focus",a),console.log("Hit <Tab> to give focus back to document (or we will face a DOMException);")})}onActionSelectPrivateSiteConfig(t){this.dataModel.linkApiPathId=this.requestLinkApiPathId,this.dataModelParentSelected=t,t&&t.id.length>0&&(this.dataModel.linkApiPathId=t.id)}onActionSelectMessageCategory(t){this.dataMessageCategoryModel=t&&t.id.length>0?t:new l._fd}onActionSelectMessageContent(t){this.dataMessageContentModel=t&&t.id.length>0?t:new l.Lnx}onActionSelectApiNumber(t){t&&t.id.length>0&&(this.dataModel.linkFromNumber=t.id)}onActionMessageContentAdd(){var t,o;(null===(o=null===(t=this.dataMessageContentModel)||void 0===t?void 0:t.messageBody)||void 0===o?void 0:o.length)>0?this.dataModel.message.length>0&&(this.dataModel.message=this.dataModel.message+" "+this.dataMessageContentModel.messageBody):this.dataModel.message=this.dataMessageContentModel.messageBody}onActionMessageContentNew(){var t,o;(null===(o=null===(t=this.dataMessageContentModel)||void 0===t?void 0:t.messageBody)||void 0===o?void 0:o.length)>0&&(this.dataModel.message=this.dataMessageContentModel.messageBody)}onFormSubmit(){if(!this.formGroup.valid)return;(!this.dataModel.linkApiPathId||this.dataModel.linkApiPathId.length<=0)&&this.cmsToastrService.typeErrorFormInvalid(),this.onActionScheduleSendCheck(),this.formInfo.formSubmitAllow=!1;const t=this.constructor.name+"main";this.loadingAction.Start(t),this.smsMainApiPathService.ServiceSendMessage(this.dataModel).subscribe({next:o=>{this.formInfo.formSubmitAllow=!0,this.dataModelResult=o,o.isSuccess?(this.formInfo.formAlert="\u062f\u0631\u062e\u0648\u0627\u0633\u062a \u0627\u0631\u0633\u0627\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u062b\u0628\u062a \u0634\u062f",this.cmsToastrService.typeSuccessMessage(this.translate.instant("MESSAGE.Send_request_was_successfully_registered"))):(this.formInfo.formAlert=this.translate.instant("ERRORMESSAGE.MESSAGE.typeError"),this.formInfo.formError=o.errorMessage,this.cmsToastrService.typeErrorMessage(o.errorMessage)),this.loadingAction.Stop(t)},error:o=>{this.formInfo.formSubmitAllow=!0,this.cmsToastrService.typeError(o),this.loadingAction.Stop(t)},complete:()=>{}})}onFormCancel(){}onActionContactCategorySelectChecked(t){if(!t||t.length<=0){const o=this.translate.instant("MESSAGE.category_of_information_is_not_clear");this.cmsToastrService.typeErrorSelected(o)}else this.dataModel.toContactCategories||(this.dataModel.toContactCategories=[]),this.dataModel.toContactContents||(this.dataModel.toContactContents=[]),this.publicHelper.listAddIfNotExist(this.dataModel.toContactCategories,t,0),(this.dataModel.toContactCategories.length>0||this.dataModel.toContactContents.length>0)&&(this.dataModel.toNumbers="")}onActionContactCategorySelectDisChecked(t){if(!t||t.length<=0){const o=this.translate.instant("MESSAGE.category_of_information_is_not_clear");this.cmsToastrService.typeErrorSelected(o)}else this.dataModel.toContactCategories||(this.dataModel.toContactCategories=[]),this.dataModel.toContactContents||(this.dataModel.toContactContents=[]),this.publicHelper.listRemoveIfExist(this.dataModel.toContactCategories,t),(this.dataModel.toContactCategories.length>0||this.dataModel.toContactContents.length>0)&&(this.dataModel.toNumbers="")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.FLW),e.Y36(l.sZP),e.Y36(T.e),e.Y36(e.sBO),e.Y36(E.i),e.Y36(_.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-sms-action-send-message"]],viewQuery:function(t,o){if(1&t&&e.Gf(se,5),2&t){let a;e.iGM(a=e.CRH())&&(o.formGroup=a.first)}},decls:74,vars:35,consts:[[3,"ngSubmit"],["vform","ngForm"],[1,"ntk-cms-html-card-header"],[1,"ntk-cms-html-card-body"],[3,"options"],[1,"row"],[1,"col-6"],["mat-stretch-tabs","",1,"example-stretched-tabs","mat-elevation-z4"],["label","\u0645\u0633\u06cc\u0631"],[3,"loading","optionSelectForce","optionPlaceholder","optionSelectFirstItem","optionChange"],[3,"loading","optionSelectForce","optionLinkApiPathId","optionPlaceholder","optionSelectFirstItem","optionChange",4,"ngIf"],["label","\u067e\u06cc\u0627\u0645 \u0647\u0627"],[3,"optionChange"],[3,"optionLinkCategryId","optionChange"],["matInput","","name","dataMessageContentModel.messageBody","type","text","rows","10",3,"ngModel","ngModelChange",4,"ngIf"],["type","button","class","btn btn-light",3,"click",4,"ngIf"],["label","\u0645\u062e\u0627\u0637\u0628"],[3,"optionSelectChecked","optionSelectDisChecked"],["label","\u0632\u0645\u0627\u0646 \u0627\u0631\u0633\u0627\u0644"],[1,"ntk-full-width"],["matInput","","name","scheduleSendDate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["matSuffix","",3,"for"],["touchUi","",3,"closed"],["scheduleSendDate",""],["matTooltip","\u0632\u0645\u0627\u0646 \u0627\u0631\u0633\u0627\u0644 \u067e\u06cc\u0627\u0645","matSuffix",""],["matInput","","name","scheduleSendClock",3,"ngxTimepicker","ngModel","format","ngModelChange"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["scheduleSendClock",""],["label","\u062a\u0646\u0638\u06cc\u0645\u0627\u062a"],["name","dataModel.isFlash",3,"ngModel","ngModelChange"],["name","dataModel.sendByQeue",3,"ngModel","ngModelChange"],[1,"col-3"],["matInput","","name","dataModel.message","type","text","placeholder","...","minlength","1","maxlength","500","rows","5",3,"ngModel","ngModelChange"],["Message",""],["matSuffix",""],[2,"text-align","left"],[4,"ngIf"],["class","ntk-full-width",4,"ngIf"],[3,"dataModel","optionMethod",4,"ngIf"],[1,"ntk-cms-html-card-message"],[1,"form-actions"],[1,"form-text","text-muted"],[1,"form-text","text-muted","danger"],[1,"ntk-cms-html-card-footer"],["class","form-actions",4,"ngIf"],[3,"loading","optionSelectForce","optionLinkApiPathId","optionPlaceholder","optionSelectFirstItem","optionChange"],["matInput","","name","dataMessageContentModel.messageBody","type","text","rows","10",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-light",3,"click"],[1,"ft-x"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["matInput","","name","dataModel.toNumbers","type","text","placeholder","0912","rows","5",3,"ngModel","ngModelChange"],["ToNumbers",""],[2,"text-align","right"],["matSuffix","",1,"info-field-icon"],[1,"info-field-text"],[3,"dataModel","optionMethod"],["type","submit","class","btn btn-success",3,"disabled","click",4,"ngIf"],["type","submit",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-check-square-o"]],template:function(t,o){if(1&t&&(e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){return o.onFormSubmit()}),e.TgZ(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"app-progress-spinner",4),e.TgZ(6,"div",5)(7,"div",6)(8,"mat-tab-group",7)(9,"mat-tab",8)(10,"app-sms-apipath-selector",9),e.NdJ("optionChange",function(s){return o.onActionSelectPrivateSiteConfig(s)}),e.qZA(),e.YNc(11,ie,1,4,"app-sms-api-number-selector",10),e.qZA(),e.TgZ(12,"mat-tab",11)(13,"app-sms-main-message-category-selector",12),e.NdJ("optionChange",function(s){return o.onActionSelectMessageCategory(s)}),e.qZA(),e.TgZ(14,"app-sms-main-message-content-selector",13),e.NdJ("optionChange",function(s){return o.onActionSelectMessageContent(s)}),e.qZA(),e.YNc(15,le,1,1,"textarea",14),e.YNc(16,ce,3,0,"button",15),e.YNc(17,de,3,0,"button",15),e.qZA(),e.TgZ(18,"mat-tab",16)(19,"app-cms-contact-category-tree-selector",17),e.NdJ("optionSelectChecked",function(s){return o.onActionContactCategorySelectChecked(s)})("optionSelectDisChecked",function(s){return o.onActionContactCategorySelectDisChecked(s)}),e.qZA()(),e.TgZ(20,"mat-tab",18)(21,"mat-form-field",19)(22,"mat-label"),e._uU(23,"\u062a\u0627\u0631\u06cc\u062e \u0627\u0631\u0633\u0627\u0644"),e.qZA(),e.TgZ(24,"input",20),e.NdJ("ngModelChange",function(s){return o.dataModelDateByClock.date=s}),e.qZA(),e.YNc(25,re,2,0,"mat-icon",21),e._UZ(26,"mat-datepicker-toggle",22),e.TgZ(27,"mat-datepicker",23,24),e.NdJ("closed",function(){return o.onActionScheduleSendCheck()}),e.qZA(),e.TgZ(29,"mat-icon",25),e._uU(30,"info"),e.qZA()(),e.TgZ(31,"mat-form-field",19)(32,"mat-label"),e._uU(33,"\u0633\u0627\u0639\u062a \u0627\u0631\u0633\u0627\u0644"),e.qZA(),e.TgZ(34,"input",26),e.NdJ("ngModelChange",function(s){return o.dataModelDateByClock.clock=s}),e.qZA(),e.TgZ(35,"mat-icon",27),e.NdJ("click",function(){return o.onActionMessageContentNew()}),e._uU(36," close"),e.qZA(),e._UZ(37,"ngx-material-timepicker-toggle",22),e.TgZ(38,"ngx-material-timepicker",23,28),e.NdJ("closed",function(){return o.onActionScheduleSendCheck()}),e.qZA()(),e._uU(40),e.ALo(41,"persianDateFull"),e._UZ(42,"hr"),e._uU(43),e.qZA(),e.TgZ(44,"mat-tab",29)(45,"div",19)(46,"mat-slide-toggle",30),e.NdJ("ngModelChange",function(s){return o.dataModel.isFlash=s}),e._uU(47," \u0627\u0631\u0633\u0627\u0644 \u0628\u0647 \u0635\u0648\u0631\u062a \u0641\u0644\u0634 "),e.qZA()(),e.TgZ(48,"div",19)(49,"mat-slide-toggle",31),e.NdJ("ngModelChange",function(s){return o.dataModel.sendByQeue=s}),e._uU(50," \u0627\u0631\u0633\u0627\u0644 \u062f\u0631 \u0635\u0641 "),e.qZA()()()()(),e.TgZ(51,"div",32)(52,"mat-form-field",19)(53,"mat-label"),e._uU(54,"\u0645\u062a\u0646 \u067e\u06cc\u0627\u0645"),e.qZA(),e.TgZ(55,"textarea",33,34),e.NdJ("ngModelChange",function(s){return o.dataModel.message=s}),e.qZA(),e.YNc(57,me,2,0,"mat-icon",21),e.TgZ(58,"mat-icon",35),e._uU(59,"mode_edit"),e.qZA(),e.TgZ(60,"mat-hint",36),e._uU(61),e.qZA(),e.YNc(62,ue,5,3,"mat-error",37),e.qZA(),e.YNc(63,pe,15,3,"mat-form-field",38),e.qZA()(),e.YNc(64,he,1,2,"app-cms-json-list",39),e.qZA(),e.TgZ(65,"div",40)(66,"div",41)(67,"small",42),e._uU(68),e.qZA(),e.TgZ(69,"small",43),e._uU(70),e.qZA()()(),e.TgZ(71,"div",44),e._UZ(72,"app-progress-spinner",4),e.YNc(73,fe,6,4,"div",45),e.qZA()()),2&t){const a=e.MAs(28),s=e.MAs(39),d=e.MAs(56);e.xp6(3),e.hij(" ",o.formInfo.formTitle," "),e.xp6(2),e.Q6J("options",o.loading),e.xp6(5),e.Q6J("loading",o.loading)("optionSelectForce",o.dataModel.linkApiPathId)("optionPlaceholder"," \u0645\u0633\u06cc\u0631")("optionSelectFirstItem",!0),e.xp6(1),e.Q6J("ngIf",(null==o.dataModel.linkApiPathId?null:o.dataModel.linkApiPathId.length)>0),e.xp6(3),e.Q6J("optionLinkCategryId",o.dataMessageCategoryModel.id),e.xp6(1),e.Q6J("ngIf",(null==o.dataMessageContentModel||null==o.dataMessageContentModel.messageBody?null:o.dataMessageContentModel.messageBody.length)>0),e.xp6(1),e.Q6J("ngIf",(null==o.dataMessageContentModel||null==o.dataMessageContentModel.messageBody?null:o.dataMessageContentModel.messageBody.length)>0&&(null==o.dataModel.message?null:o.dataModel.message.length)>0),e.xp6(1),e.Q6J("ngIf",(null==o.dataMessageContentModel||null==o.dataMessageContentModel.messageBody?null:o.dataMessageContentModel.messageBody.length)>0),e.xp6(7),e.Q6J("matDatepicker",a)("ngModel",o.dataModelDateByClock.date),e.xp6(1),e.Q6J("ngIf",a),e.xp6(1),e.Q6J("for",a),e.xp6(8),e.Q6J("ngxTimepicker",s)("ngModel",o.dataModelDateByClock.clock)("format",24),e.xp6(3),e.Q6J("for",s),e.xp6(3),e.hij(" ",e.lcZ(41,33,o.dataModel.scheduleSend)," "),e.xp6(3),e.hij("\n",o.dataModel.scheduleSend," "),e.xp6(3),e.Q6J("ngModel",o.dataModel.isFlash),e.xp6(3),e.Q6J("ngModel",o.dataModel.sendByQeue),e.xp6(6),e.Q6J("ngModel",o.dataModel.message),e.xp6(2),e.Q6J("ngIf",o.dataModel.message),e.xp6(4),e.hij("",d.value.length," / 500"),e.xp6(1),e.Q6J("ngIf",null==d.errors?null:d.errors.required),e.xp6(1),e.Q6J("ngIf",!(o.dataModel.toContactCategories&&0!=(null==o.dataModel.toContactCategories?null:o.dataModel.toContactCategories.length)||o.dataModel.toContactContents&&0!=(null==o.dataModel.toContactContents?null:o.dataModel.toContactContents.length))),e.xp6(1),e.Q6J("ngIf",null==o.dataModelResult?null:o.dataModelResult.item),e.xp6(4),e.hij("",o.formInfo.formAlert," "),e.xp6(2),e.hij("",o.formInfo.formError," "),e.xp6(2),e.Q6J("options",o.loadingAction),e.xp6(1),e.Q6J("ngIf",o.formInfo.formSubmitAllow&&!o.loading.display)}},directives:[r._Y,r.JL,r.F,J.O,b.SP,b.uX,w.s,C.O5,D.y,O.b,G,N.Nt,r.Fj,r.JJ,r.On,ee,u.KE,u.hX,k.hl,A.Hw,u.R9,k.nW,k.Mq,te.gM,y.I2,y.u_,y.ro,oe.Rr,r.wO,r.nD,u.bx,u.TO,ne.v],pipes:[ae.K,_.X$],styles:[".form-body[_ngcontent-%COMP%]{width:500px}@media (max-width: 700px){.form-body[_ngcontent-%COMP%]{display:contents}}#file-manager[_ngcontent-%COMP%]{width:calc(100vw - 16px);height:calc(100vh - 16px)}.recordStatus-1.mat-select-panel[_ngcontent-%COMP%]{background:yellow}.recordStatus-2.mat-select-panel[_ngcontent-%COMP%]{background:black}.recordStatus-3.mat-select-panel[_ngcontent-%COMP%]{background:red}.mat-tab-group[_ngcontent-%COMP%]{height:95%}"]}),n})()}]}];let _e=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[v.Bz.forChild(Se)],v.Bz]}),n})();var Ae=i(2489),ye=i(8601),ve=i(6720),Te=i(3914),ke=i(5103),Ze=i(4586);let xe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[l.EAm,l.FLW,l.Z8z,Te.s,l.dF2,l.sZP,l.buc,l.GrT],imports:[[C.ez,Ze.SmsMainModule,_e,r.u5,r.UX.withConfig({warnOnNgModelWithFormControl:"never"}),Ae.m.forRoot(),ye.UM,y.rK,A.Ps,u.lN,ve.T5,ke.r]]}),n})()}}]);