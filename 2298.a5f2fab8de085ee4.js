"use strict";(self.webpackChunkntk_cms_web=self.webpackChunkntk_cms_web||[]).push([[2298],{2298:(De,J,r)=>{r.r(J),r.d(J,{SmsActionModule:()=>Ue});var M=r(1048),E=r(7076),F=r(8239),c=r(7977),x=r(656),t=r(9724),k=r(2607),W=r(3029),Z=r(4817),m=r(1659),X=r(5738),O=r(4311),K=r(8024),z=r(8161),tt=r(600),et=r(1927),nt=r(3151),ot=r(2147),it=r(1528),U=r(7969),f=r(5691),D=r(8904),B=r(5821),Q=r(1531),w=r(4848);function st(o,a){if(1&o&&(t.TgZ(0,"mat-option",6)(1,"span"),t._uU(2),t.qZA()()),2&o){const e=a.$implicit,n=t.oxw();t.Q6J("value",e)("disabled",n.optionDisabled),t.xp6(2),t.Oqu(n.displayOption(e))}}function at(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().onActionSelectClear()}),t._uU(1,"close"),t.qZA()}}const lt=["*"];let rt=(()=>{class o{constructor(e,n,i,s,l){this.coreEnumService=e,this.cmsToastrService=n,this.cdr=i,this.translate=s,this.categoryService=l,this.dataModelResult=new c.y$4,this.dataModelSelect=new c.Lnx,this.loading=new x.O,this.formControl=new m.NI,this.optionPlaceholder="",this.optionSelectFirstItem=!1,this.optionChange=new t.vpe,this.optionReload=()=>this.onActionReload(),this.optionDisabled=!1,this.privateLinkCategryId="",this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information")}set optionSelectForce(e){this.onActionSelectForce(e)}set optionLinkCategryId(e){e!=this.privateLinkCategryId&&(""!=this.privateLinkCategryId&&this.onActionSelectClear(),this.privateLinkCategryId=e,this.loadOptions())}ngOnInit(){this.loadOptions()}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe((0,et.O)(""),(0,nt.b)(1500),(0,ot.x)(),(0,it.w)(e=>"string"==typeof e||"number"==typeof e?this.DataGetAll(e||""):[]))}displayFn(e){return e?e.title:void 0}displayOption(e){return e?e.title:void 0}DataGetAll(e){var n=this;return(0,F.Z)(function*(){const i=new c.Hay;i.rowPerPage=20,i.accessLoad=!0;let s=new c.AO3;s.propertyName="Title",s.value=e,s.searchType=c.b3P.Contains,s.clauseType=c.KT6.Or,i.filters.push(s),e&&"string"==typeof+e&&+e>0&&(s=new c.AO3,s.propertyName="Id",s.value=e,s.searchType=c.b3P.Equal,s.clauseType=c.KT6.Or,i.filters.push(s)),n.privateLinkCategryId&&n.privateLinkCategryId.length>0&&(s=new c.AO3,s.propertyName="linkCategoryId",s.value=n.privateLinkCategryId,s.searchType=c.b3P.Equal,i.filters.push(s));const l=n.constructor.name+"main";return n.loading.Start(l),yield n.categoryService.ServiceGetAll(i).pipe((0,U.U)(d=>(n.dataModelResult=d,n.optionSelectFirstItem&&(!n.dataModelSelect||!n.dataModelSelect.id||0==n.dataModelSelect.id.length)&&n.dataModelResult.listItems.length>0&&(n.optionSelectFirstItem=!1,setTimeout(()=>{n.formControl.setValue(n.dataModelResult.listItems[0]),n.onActionSelect(n.dataModelResult.listItems[0])},1e3)),n.loading.Stop(l),d.listItems))).toPromise()})()}onActionSelect(e){this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect)}onActionSelectClear(){this.formControl.setValue(null),this.optionChange.emit(null)}push(e){return this.filteredOptions.pipe((0,U.U)(n=>(n.find(i=>i.id===e.id)||n.push(e),n)))}onActionSelectForce(e){if("string"==typeof e&&e.length>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(n=>n.id===e)){const n=this.dataModelResult.listItems.find(i=>i.id===e);return this.dataModelSelect=n,void this.formControl.setValue(n)}this.categoryService.ServiceGetOneById(e).subscribe({next:n=>{n.isSuccess?(this.filteredOptions=this.push(n.item),this.dataModelSelect=n.item,this.formControl.setValue(n.item),this.optionChange.emit(n.item)):this.cmsToastrService.typeErrorMessage(n.errorMessage)}})}else{if(typeof e==typeof c.Lnx)return this.filteredOptions=this.push(e),this.dataModelSelect=e,void this.formControl.setValue(e);this.formControl.setValue(null)}}onActionReload(){this.dataModelSelect=new c.Lnx,this.DataGetAll(null)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(c.FLW),t.Y36(k.e),t.Y36(t.sBO),t.Y36(Z.sK),t.Y36(c.ULy))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sms-main-message-content-selector"]],inputs:{loading:"loading",optionPlaceholder:"optionPlaceholder",optionSelectFirstItem:"optionSelectFirstItem",optionReload:"optionReload",optionSelectForce:"optionSelectForce",optionLinkCategryId:"optionLinkCategryId",optionDisabled:"optionDisabled"},outputs:{optionChange:"optionChange"},ngContentSelectors:lt,decls:8,vars:8,consts:[[1,"ntk-full-width"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto27","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[3,"value","disabled"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(e,n){if(1&e&&(t.F$t(),t.TgZ(0,"mat-form-field",0),t._UZ(1,"input",1),t.TgZ(2,"mat-autocomplete",2,3),t.NdJ("optionSelected",function(s){return n.onActionSelect(s.option.value)}),t.YNc(4,st,3,3,"mat-option",4),t.ALo(5,"async"),t.qZA(),t.YNc(6,at,2,0,"mat-icon",5),t.Hsn(7),t.qZA()),2&e){const i=t.MAs(3);t.xp6(1),t.s9C("placeholder",n.optionPlaceholder),t.Q6J("formControl",n.formControl)("matAutocomplete",i),t.xp6(1),t.Q6J("displayWith",n.displayFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(5,6,n.filteredOptions)),t.xp6(2),t.Q6J("ngIf",n.dataModelSelect.id)}},directives:[f.KE,D.Nt,m.Fj,B.ZL,m.JJ,m.oH,B.XC,M.sg,Q.ey,M.O5,w.Hw,f.R9],pipes:[M.Ov],encapsulation:2}),o})();var ct=r(4405),S=r(4187),dt=r(9252),ut=r(8485),mt=r(727),N=r(3472),pt=r(6088);function gt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-tree-node",6),t._UZ(1,"button",7),t.TgZ(2,"mat-checkbox",8),t.NdJ("change",function(){const s=t.CHM(e).$implicit;return t.oxw().checklistSelection.toggle(s)}),t._uU(3),t.qZA()()}if(2&o){const e=a.$implicit,n=t.oxw();t.xp6(2),t.Q6J("checked",n.checklistSelection.isSelected(e)),t.xp6(1),t.Oqu(e.title)}}function ht(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-nested-tree-node")(1,"li")(2,"div",9)(3,"button",10)(4,"mat-icon",11),t._uU(5),t.qZA()(),t.TgZ(6,"mat-checkbox",12),t.NdJ("change",function(){const s=t.CHM(e).$implicit;return t.oxw().todoItemSelectionToggle(s)}),t._uU(7),t.qZA()(),t.TgZ(8,"ul"),t.GkF(9,13),t.qZA()()()}if(2&o){const e=a.$implicit,n=t.oxw();t.xp6(3),t.uIk("aria-label","Toggle "+e.title),t.xp6(2),t.hij(" ",n.treeControl.isExpanded(e)?"expand_more":"chevron_right"," "),t.xp6(1),t.Q6J("checked",n.checklistSelection.isSelected(e))("indeterminate",n.descendantsPartiallySelected(e)),t.xp6(1),t.hij(" ",e.title,""),t.xp6(1),t.ekj("category-tree-invisible",!n.treeControl.isExpanded(e))}}let _t=(()=>{class o{constructor(e,n,i,s,l,d,u){this.cmsToastrService=e,this.coreEnumService=n,this.categoryService=i,this.cdr=s,this.dialog=l,this.translate=d,this.tokenHelper=u,this.dataModelSelect=[],this.dataModelResult=new c.y$4,this.filteModel=new c.Hay,this.loading=new x.O,this.treeControl=new ct.VY(p=>p.children),this.dataSource=new S.WX,this.runComplate=!1,this.optionSelectChecked=new t.vpe,this.optionSelectDisChecked=new t.vpe,this.optionModelChange=new t.vpe,this.checklistSelection=new dt.Ov(!0),this.hasChild=(p,h)=>!!h.children&&h.children.length>0,this.hasNoContent=(p,h)=>h.children,this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information"),this.checklistSelection.changed.subscribe(p=>{if(!this.runComplate)return;const h=[];this.checklistSelection.selected.forEach(_=>{h.push(_.id)}),this.optionModelChange.emit(h),p.added&&p.added.length>0&&p.added.forEach(_=>{this.optionSelectChecked.emit(_.id)}),p.removed&&p.removed.length>0&&p.removed.forEach(_=>{this.optionSelectDisChecked.emit(_.id)})})}set optionModel(e){this.dataModelSelect=e,this.loadCheked()}ngOnInit(){this.DataGetAll(),this.cmsApiStoreSubscribe=this.tokenHelper.getCurrentTokenOnChange().subscribe(e=>{this.DataGetAll()})}ngOnDestroy(){this.cmsApiStoreSubscribe.unsubscribe()}loadCheked(e=this.treeControl.dataNodes){this.runComplate=!1,this.treeControl.dataNodes&&this.dataModelSelect&&this.dataModelSelect.length>0&&e.forEach(n=>{this.dataModelSelect.find(s=>s===n.id)&&this.checklistSelection.select(n),n.children&&n.children.length>0&&this.loadCheked(n.children)}),this.runComplate=!0}DataGetAll(){this.filteModel.rowPerPage=200,this.filteModel.accessLoad=!0;const e=this.constructor.name+"main";this.loading.Start(e),this.categoryService.ServiceGetAll(this.filteModel).subscribe({next:n=>{n.isSuccess?(this.dataModelResult=n,this.dataSource.data=this.dataModelResult.listItems,this.treeControl.dataNodes=this.dataModelResult.listItems,this.loadCheked()):this.cmsToastrService.typeErrorMessage(n.errorMessage),this.loading.Stop(e)},error:n=>{this.loading.Stop(e),this.cmsToastrService.typeError(n)}})}descendantsAllSelected(e){return this.treeControl.getDescendants(e).every(i=>this.checklistSelection.isSelected(i))}descendantsPartiallySelected(e){return this.treeControl.getDescendants(e).some(s=>this.checklistSelection.isSelected(s))&&!this.descendantsAllSelected(e)}todoItemSelectionToggle(e){this.checklistSelection.toggle(e);const n=this.treeControl.getDescendants(e);this.checklistSelection.isSelected(e)?this.checklistSelection.select(...n):this.checklistSelection.deselect(...n)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(k.e),t.Y36(c.FLW),t.Y36(c.buc),t.Y36(t.sBO),t.Y36(ut.uw),t.Y36(Z.sK),t.Y36(mt.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-cms-contact-category-tree-selector"]],inputs:{optionModel:"optionModel"},outputs:{optionSelectChecked:"optionSelectChecked",optionSelectDisChecked:"optionSelectDisChecked",optionModelChange:"optionModelChange"},decls:6,vars:3,consts:[[1,"ntk-cms-html-tree-header"],[1,"ntk-cms-html-tree-body"],[1,"category-tree","cursor-pointer",3,"dataSource","treeControl"],["matTreeNodePadding","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"ntk-cms-html-tree-footer"],["matTreeNodePadding",""],["type","button","mat-icon-button","","disabled",""],[1,"checklist-leaf-node",3,"checked","change"],[1,"mat-tree-node"],["type","button","mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],[3,"checked","indeterminate","change"],["matTreeNodeOutlet",""]],template:function(e,n){1&e&&(t._UZ(0,"div",0),t.TgZ(1,"div",1)(2,"mat-tree",2),t.YNc(3,gt,4,2,"mat-tree-node",3),t.YNc(4,ht,10,7,"mat-nested-tree-node",4),t.qZA()(),t._UZ(5,"div",5)),2&e&&(t.xp6(2),t.Q6J("dataSource",n.dataSource)("treeControl",n.treeControl),t.xp6(2),t.Q6J("matTreeNodeDefWhen",n.hasChild))},directives:[S.gi,S.fQ,S.uo,S.ah,N.lW,pt.oG,S.GZ,S.eu,w.Hw,S.Ar],encapsulation:2}),o})();var I=r(38),ft=r(8543),b=r(558),q=r(1450),Ct=r(5557),Mt=r(3528);function St(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function At(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select how many minutes between jobs"),t.qZA())}function yt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Minutes between"),t.qZA(),t.TgZ(4,"mat-select",3),t.YNc(5,St,2,2,"mat-option",4),t.qZA(),t.YNc(6,At,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.minutesBetween),t.xp6(1),t.Q6J("ngIf",e.cronOptions.showHints)}}function Tt(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function vt(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select how many hours between jobs"),t.qZA())}function xt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Hours between"),t.qZA(),t.TgZ(4,"mat-select",6),t.YNc(5,Tt,2,2,"mat-option",4),t.qZA(),t.YNc(6,vt,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.hoursBetween),t.xp6(1),t.Q6J("ngIf",e.cronOptions.showHints)}}function Zt(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function wt(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select how many days between jobs"),t.qZA())}function bt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Days between"),t.qZA(),t.TgZ(4,"mat-select",7),t.YNc(5,Zt,2,2,"mat-option",4),t.qZA(),t.YNc(6,wt,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.datesBetween),t.xp6(1),t.Q6J("ngIf",e.cronOptions.showHints)}}function Et(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function kt(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select how many months between jobs"),t.qZA())}function Nt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Months between"),t.qZA(),t.TgZ(4,"mat-select",8),t.YNc(5,Et,2,2,"mat-option",4),t.qZA(),t.YNc(6,kt,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.monthsBetween),t.xp6(1),t.Q6J("ngIf",e.cronOptions.showHints)}}function It(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function Jt(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select how many weekdays between jobs"),t.qZA())}function Ft(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Weekdays between"),t.qZA(),t.TgZ(4,"mat-select",9),t.YNc(5,It,2,2,"mat-option",4),t.qZA(),t.YNc(6,Jt,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.daysBetween),t.xp6(1),t.Q6J("ngIf",e.cronOptions.showHints)}}function Ot(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return i.selectAll("minutesCronControl",i.minutes,0)}),t._uU(1,"Select All "),t.qZA()}}function Ut(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).unSelectAll("minutesCronControl")}),t._uU(1,"Unselect All "),t.qZA()}}function Dt(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function Bt(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select which minutes of the hour"),t.qZA())}function Qt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"At Minutes"),t.qZA(),t.TgZ(4,"mat-select",10),t.YNc(5,Ot,2,0,"button",11),t.YNc(6,Ut,2,0,"ng-template",null,12,t.W1O),t.YNc(8,Dt,2,2,"mat-option",4),t.qZA(),t.YNc(9,Bt,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.MAs(7),n=t.oxw();t.xp6(5),t.Q6J("ngIf",n.cronEditorForm.get("minutesCronControl").value.length!==n.minutes.length)("ngIfElse",e),t.xp6(3),t.Q6J("ngForOf",n.minutes),t.xp6(1),t.Q6J("ngIf",n.cronOptions.showHints)}}function qt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return i.selectAll("hoursCronControl",i.hours,1)}),t._uU(1,"Select All "),t.qZA()}}function Yt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).unSelectAll("hoursCronControl")}),t._uU(1,"Unselect All "),t.qZA()}}function Ht(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function Pt(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select which hours of the day"),t.qZA())}function jt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"On Hours"),t.qZA(),t.TgZ(4,"mat-select",14),t.YNc(5,qt,2,0,"button",11),t.YNc(6,Yt,2,0,"ng-template",null,15,t.W1O),t.YNc(8,Ht,2,2,"mat-option",4),t.qZA(),t.YNc(9,Pt,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.MAs(7),n=t.oxw();t.xp6(5),t.Q6J("ngIf",n.cronEditorForm.get("hoursCronControl").value.length!==n.hours.length)("ngIfElse",e),t.xp6(3),t.Q6J("ngForOf",n.hours),t.xp6(1),t.Q6J("ngIf",n.cronOptions.showHints)}}function Lt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return i.selectAll("datesCronControl",i.monthDays,2)}),t._uU(1,"Select All "),t.qZA()}}function Rt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).unSelectAll("datesCronControl")}),t._uU(1,"Unselect All "),t.qZA()}}function Vt(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.Oqu(e.friendly)}}function $t(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select which dates of the month"),t.qZA())}function Gt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"On Dates"),t.qZA(),t.TgZ(4,"mat-select",16),t.YNc(5,Lt,2,0,"button",11),t.YNc(6,Rt,2,0,"ng-template",null,17,t.W1O),t.YNc(8,Vt,2,2,"mat-option",4),t.qZA(),t.YNc(9,$t,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.MAs(7),n=t.oxw();t.xp6(5),t.Q6J("ngIf",n.cronEditorForm.get("datesCronControl").value.length!==n.monthDays.length)("ngIfElse",e),t.xp6(3),t.Q6J("ngForOf",n.monthDays),t.xp6(1),t.Q6J("ngIf",n.cronOptions.showHints)}}function Wt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return i.selectAll("monthsCronControl",i.months,3)}),t._uU(1,"Select All "),t.qZA()}}function Xt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).unSelectAll("monthsCronControl")}),t._uU(1,"Unselect All "),t.qZA()}}function Kt(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.Oqu(e.friendly)}}function zt(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select which months of the year"),t.qZA())}function te(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"For Months"),t.qZA(),t.TgZ(4,"mat-select",18),t.YNc(5,Wt,2,0,"button",11),t.YNc(6,Xt,2,0,"ng-template",null,19,t.W1O),t.YNc(8,Kt,2,2,"mat-option",4),t.qZA(),t.YNc(9,zt,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.MAs(7),n=t.oxw();t.xp6(5),t.Q6J("ngIf",n.cronEditorForm.get("monthsCronControl").value.length!==n.months.length)("ngIfElse",e),t.xp6(3),t.Q6J("ngForOf",n.months),t.xp6(1),t.Q6J("ngIf",n.cronOptions.showHints)}}function ee(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return i.selectAll("daysCronControl",i.weekDays,4)}),t._uU(1,"Select All "),t.qZA()}}function ne(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).unSelectAll("daysCronControl")}),t._uU(1,"Unselect All "),t.qZA()}}function oe(o,a){if(1&o&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.friendly," ")}}function ie(o,a){1&o&&(t.TgZ(0,"mat-hint"),t._uU(1,"Select which days of the week"),t.qZA())}function se(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"On Days"),t.qZA(),t.TgZ(4,"mat-select",20),t.YNc(5,ee,2,0,"button",11),t.YNc(6,ne,2,0,"ng-template",null,21,t.W1O),t.YNc(8,oe,2,2,"mat-option",4),t.qZA(),t.YNc(9,ie,2,0,"mat-hint",2),t.qZA(),t.BQk()),2&o){const e=t.MAs(7),n=t.oxw();t.xp6(5),t.Q6J("ngIf",n.cronEditorForm.get("daysCronControl").value.length!==n.weekDays.length)("ngIfElse",e),t.xp6(3),t.Q6J("ngForOf",n.weekDays),t.xp6(1),t.Q6J("ngIf",n.cronOptions.showHints)}}const ae=function(o){return{display:"flex","flex-direction":o}},Y=function(o){return{"flex-direction":o}};let le=(()=>{class o{constructor(){}range(e,n){return Array(e).fill(1).map((s,l)=>{if(24===e){const d=function i(s){let l,d;return s>=12?(d=s-12,l=`${s}  (${d} PM)`,12===s&&(l=`${s}  (12 PM)`)):(l=`${s}  (${s} AM)`,0===s&&(l=`${s}  (12 AM)`)),l}(n?s+l-1:s+l);return{value:n?s+l-1:s+l,friendly:d}}return{value:n?s+l-1:s+l,friendly:n?s+l-1:s+l}})}rangeOptions(e,n){return[{value:"",friendly:"n/a"},...Array(e).fill(1).map((s,l)=>({value:`*/${s+l}`,friendly:`Every ${s+l} ${n}${s+l>1?"s":""}`}))]}plainRange(e,n){return Array(e).fill(1).map((i,s)=>n?i+s-1:i+s)}formatSequentialValues(e,n){const i={};let l,s=0,d="";e.forEach(u=>{parseInt(`${u}`,10)-1!==parseInt(`${l}`,10)&&s++,i[s]?i[s].push(u):i[s]=[u],l=u});for(const u in i)1===i[u].length?d+=i[u][0]+",":i[u].length>1&&(d+=i[u][0]+"-"+i[u][i[u].length-1]+",");return d=d.slice(0,-1),"minutes"===n&&"0-59"===d||"hours"===n&&"0-23"===d||"dates"===n&&"1-31"===d||"months"===n&&"1-12"===d||"days"===n&&"0-6"===d?"*":d}deFormatSequentialValues(e,n,i){if("*"===e)return this.plainRange(n,i);if(1===e.length)return[parseInt(e,10)];let s;const l=[];return e.indexOf(",")>-1&&(s=e.split(",")),(null==s?void 0:s.length)?s.forEach(u=>{u.indexOf("-")>-1?d(u):l.push(u)}):e.indexOf("-")>-1?d(e):l.push(e),l.map(u=>parseInt(u,10));function d(u){const p=u.split("-"),h=parseInt(p[0],10),_=parseInt(p[1],10);for(let C=h;C<=_;C++)l.push(C)}}validateCron(e){const n=e.split(" ");if(!n)throw new Error("Must provide default cron");if(5!==n.length)throw new Error("Cron expression must have 5 segments: minutes, hours, dates(of the months), months, days(of the week)")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=(0,t.Yz7)({factory:function(){return new o},token:o,providedIn:"root"}),o})();const H={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6},P={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};let re=(()=>{class o{constructor(e){this.utils=e,this.cronEvent=new t.vpe,this.cronOptions={includeMinutes:!1,includeHours:!1,includeDates:!1,includeMonths:!1,includeDays:!1,includeMinutesBetween:!1,includeHoursBetween:!1,includeDatesBetween:!1,includeMonthsBetween:!1,includeDaysBetween:!1,showHints:!0,defaultCron:"0 0 0 0 0",flexDirection:"row"},this.minutesBetween=this.utils.rangeOptions(60,"minute"),this.hoursBetween=this.utils.rangeOptions(24,"hour"),this.datesBetween=this.utils.rangeOptions(31,"day"),this.monthsBetween=this.utils.rangeOptions(12,"month"),this.daysBetween=this.utils.rangeOptions(7,"weekday"),this.minutes=this.utils.range(60,!0),this.hours=this.utils.range(24,!0),this.monthDays=this.utils.range(31),this.weekDays=Object.keys(H).map(n=>({value:H[n],friendly:n})),this.months=Object.keys(P).map(n=>({value:P[n],friendly:n})),this.destroyer$=new Ct.t(null),this.cronString="* * * * *"}ngOnInit(){this.cronString=this.cronOptions.defaultCron,this.utils.validateCron(this.cronOptions.defaultCron),this.cronEditorForm=new m.cw({minutesBetweenCronControl:new m.NI(""),hoursBetweenCronControl:new m.NI(""),datesBetweenCronControl:new m.NI(""),daysBetweenCronControl:new m.NI(""),monthsBetweenCronControl:new m.NI(""),minutesCronControl:new m.NI([]),hoursCronControl:new m.NI([]),datesCronControl:new m.NI([]),monthsCronControl:new m.NI([]),daysCronControl:new m.NI([])}),this.setControlValues(),this.cronEditorForm.valueChanges.pipe((0,Mt.R)(this.destroyer$)).subscribe(e=>{this.emitCron()})}setControlValues(){var e;if(null===(e=this.cronOptions)||void 0===e?void 0:e.defaultCron){const[n,i,s,l,d]=this.cronOptions.defaultCron.split(" "),u=n.split(","),p=u.filter(g=>/\*\/\d/g.test(g)),h=u.filter(g=>!/\*\/\d/g.test(g));p[0]&&this.cronEditorForm.get("minutesBetweenCronControl").setValue(p[0]),h.length&&this.cronEditorForm.get("minutesCronControl").setValue(this.utils.deFormatSequentialValues(h.join(","),60,!0));const _=i.split(","),C=_.filter(g=>/\*\/\d/g.test(g)),A=_.filter(g=>!/\*\/\d/g.test(g));C[0]&&this.cronEditorForm.get("hoursBetweenCronControl").setValue(C[0]),A.length&&this.cronEditorForm.get("hoursCronControl").setValue(this.utils.deFormatSequentialValues(A.join(","),24,!0));const y=s.split(","),T=y.filter(g=>/\*\/\d/g.test(g)),v=y.filter(g=>!/\*\/\d/g.test(g));T[0]&&this.cronEditorForm.get("datesBetweenCronControl").setValue(T[0]),v.length&&this.cronEditorForm.get("datesCronControl").setValue(this.utils.deFormatSequentialValues(v.join(","),31));const j=d.split(","),L=j.filter(g=>/\*\/\d/g.test(g)),R=j.filter(g=>!/\*\/\d/g.test(g));L[0]&&this.cronEditorForm.get("daysBetweenCronControl").setValue(L[0]),R.length&&this.cronEditorForm.get("daysCronControl").setValue(this.utils.deFormatSequentialValues(R.join(","),7,!0));const V=l.split(","),$=V.filter(g=>/\*\/\d/g.test(g)),G=V.filter(g=>!/\*\/\d/g.test(g));$[0]&&this.cronEditorForm.get("monthsBetweenCronControl").setValue($[0]),G.length&&this.cronEditorForm.get("monthsCronControl").setValue(this.utils.deFormatSequentialValues(G.join(","),12,!0))}}emitCron(){this.cronEvent.emit({cronForm:this.cronEditorForm,cronValue:this.finalCronFormat()})}selectAll(e,n,i){const s=this.cronEditorForm.get(e),l=n.map(d=>d.value);s.setValue(l)}unSelectAll(e){this.cronEditorForm.get(e).setValue([])}finalCronFormat(){let e,n,i,s,l;const d=this.cronEditorForm.get("minutesBetweenCronControl").value,u=this.utils.formatSequentialValues(this.cronEditorForm.get("minutesCronControl").value,"minutes");e=d&&u.length?[d,...u.split(",")].join(","):d&&!u.length?d:u;const p=this.cronEditorForm.get("hoursBetweenCronControl").value,h=this.utils.formatSequentialValues(this.cronEditorForm.get("hoursCronControl").value,"hours");n=p&&h.length?[p,...h.split(",")].join(","):p&&!h.length?p:h;const _=this.cronEditorForm.get("datesBetweenCronControl").value,C=this.utils.formatSequentialValues(this.cronEditorForm.get("datesCronControl").value,"dates");i=_&&C.length?[_,...C.split(",")].join(","):_&&!C.length?_:C;const A=this.cronEditorForm.get("monthsBetweenCronControl").value,y=this.utils.formatSequentialValues(this.cronEditorForm.get("monthsCronControl").value,"months");s=A&&y.length?[A,...y.split(",")].join(","):A&&!y.length?A:y;const T=this.cronEditorForm.get("daysBetweenCronControl").value,v=this.utils.formatSequentialValues(this.cronEditorForm.get("daysCronControl").value,"days");return l=T&&v.length?[T,...v.split(",")].join(","):T&&!v.length?T:v,`${e} ${n} ${i} ${s} ${l}`}ngOnDestroy(){this.destroyer$.next(!0),this.destroyer$.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(le))},o.\u0275cmp=t.Xpm({type:o,selectors:[["mat-cron-editor"]],inputs:{cronOptions:"cronOptions"},outputs:{cronEvent:"cronEvent"},decls:13,vars:20,consts:[[3,"formGroup","ngStyle"],[1,"flex-container",3,"ngStyle"],[4,"ngIf"],["formControlName","minutesBetweenCronControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","hoursBetweenCronControl"],["formControlName","datesBetweenCronControl"],["formControlName","monthsBetweenCronControl"],["formControlName","daysBetweenCronControl"],["formControlName","minutesCronControl","multiple",""],["mat-button","","class","mat-option",3,"click",4,"ngIf","ngIfElse"],["unSelectMinutes",""],["mat-button","",1,"mat-option",3,"click"],["formControlName","hoursCronControl","multiple",""],["unSelectHours",""],["multiple","","formControlName","datesCronControl"],["unSelectDates",""],["multiple","","formControlName","monthsCronControl"],["unSelectMonths",""],["multiple","","formControlName","daysCronControl"],["unSelectDays",""]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"div",1),t.YNc(2,yt,7,2,"ng-container",2),t.YNc(3,xt,7,2,"ng-container",2),t.YNc(4,bt,7,2,"ng-container",2),t.YNc(5,Nt,7,2,"ng-container",2),t.YNc(6,Ft,7,2,"ng-container",2),t.qZA(),t.TgZ(7,"div",1),t.YNc(8,Qt,10,4,"ng-container",2),t.YNc(9,jt,10,4,"ng-container",2),t.YNc(10,Gt,10,4,"ng-container",2),t.YNc(11,te,10,4,"ng-container",2),t.YNc(12,se,10,4,"ng-container",2),t.qZA()()),2&e&&(t.Q6J("formGroup",n.cronEditorForm)("ngStyle",t.VKq(14,ae,"row"===n.cronOptions.flexDirection?"column":"row")),t.xp6(1),t.Q6J("ngStyle",t.VKq(16,Y,n.cronOptions.flexDirection)),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeMinutesBetween),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeHoursBetween),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeDatesBetween),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeMonthsBetween),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeDaysBetween),t.xp6(1),t.Q6J("ngStyle",t.VKq(18,Y,n.cronOptions.flexDirection)),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeMinutes),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeHours),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeDates),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeMonths),t.xp6(1),t.Q6J("ngIf",n.cronOptions.includeDays))},directives:[m._Y,m.JL,m.sg,M.PC,M.O5,f.KE,f.hX,q.gD,m.JJ,m.u,M.sg,Q.ey,f.bx,N.lW],styles:[".flex-container[_ngcontent-%COMP%]{align-items:stretch;display:flex;flex-wrap:wrap;justify-content:space-around;margin:1rem 0}.flex-container[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{flex:1 1 0;margin:.5rem .25rem}"]}),o})(),ce=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[f.lN,q.LD,M.ez,m.UX,N.ot]]}),o})();var de=r(1582),ue=r(2370),me=r(2022);const pe=["vform"],ge=["defaultCron"];function he(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"app-sms-api-number-selector",48),t.NdJ("optionChange",function(i){return t.CHM(e),t.oxw().onActionSelectApiNumber(i)}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("loading",e.loading)("optionLinkApiPathId",e.dataModel.linkApiPathId)("optionPlaceholder"," \u0634\u0645\u0627\u0631\u0647 \u0641\u0631\u0633\u062a\u0646\u062f\u0647")("optionSelectFirstItem",!0)}}function _e(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"textarea",49),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().dataMessageContentModel.messageBody=i}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("ngModel",e.dataMessageContentModel.messageBody)}}function fe(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().onActionMessageContentAdd()}),t._UZ(1,"i",51),t._uU(2," \u0627\u0636\u0627\u0641\u0647 \u0628\u0647 \u0645\u062a\u0646 "),t.qZA()}}function Ce(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().onActionMessageContentNew()}),t._UZ(1,"i",51),t._uU(2," \u0645\u062a\u0646 \u067e\u06cc\u0627\u0645 "),t.qZA()}}function Me(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",52),t.NdJ("click",function(){return t.CHM(e),t.oxw().onActionMessageContentNew()}),t._uU(1,"close"),t.qZA()}}function Se(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",52),t.NdJ("click",function(){return t.CHM(e),t.oxw().dataModel.message=""}),t._uU(1,"close"),t.qZA()}}function Ae(o,a){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," \u0645\u062a\u0646 \u067e\u06cc\u0627\u0645 "),t.TgZ(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&o&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"MESSAGE.required")))}function ye(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-icon",52),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).dataModel.toNumbers=""}),t._uU(1,"close"),t.qZA()}}function Te(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-form-field",19)(1,"mat-label"),t._uU(2,"\u0634\u0645\u0627\u0631\u0647 \u06af\u06cc\u0631\u0646\u062f\u0647"),t.qZA(),t.TgZ(3,"textarea",53,54),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().dataModel.toNumbers=i}),t.qZA(),t.YNc(5,ye,2,0,"mat-icon",21),t.TgZ(6,"mat-icon",37),t._uU(7,"mode_edit"),t.qZA(),t.TgZ(8,"mat-hint",55)(9,"mat-icon",56),t._uU(10,"info"),t.qZA(),t.TgZ(11,"strong",57),t._uU(12,"\u0634\u0645\u0627\u0631\u0647 \u06af\u06cc\u0631\u0646\u062f\u0647 \u067e\u06cc\u0627\u0645 \u0631\u0627 \u0645\u06cc \u062a\u0648\u0627\u0646\u06cc\u062f \u0628\u0627 \u06a9\u0627\u0645\u0627 \u0627\u0632 \u0647\u0645 \u062c\u062f\u0627 \u06a9\u0646\u06cc\u062f"),t.qZA()(),t.TgZ(13,"mat-hint",38),t._uU(14),t.qZA()()}if(2&o){const e=t.MAs(4),n=t.oxw();t.xp6(3),t.Q6J("ngModel",n.dataModel.toNumbers),t.xp6(2),t.Q6J("ngIf",n.dataModel.toNumbers),t.xp6(9),t.hij("",e.value.length," / 500")}}function ve(o,a){if(1&o&&t._UZ(0,"app-cms-json-list",58),2&o){const e=t.oxw();t.Q6J("dataModel",e.dataModelResult.item)("optionMethod",1)}}function xe(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onFormSubmit()}),t._UZ(1,"i",61),t._uU(2),t.ALo(3,"translate"),t.qZA()}if(2&o){t.oxw(2);const e=t.MAs(1);t.Q6J("disabled",!e.valid),t.xp6(2),t.hij(" ",t.lcZ(3,2,"ACTION.Send_Message")," ")}}function Ze(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",43)(1,"button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().onFormCancel()}),t._UZ(2,"i",51),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,xe,4,4,"button",59),t.qZA()}if(2&o){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,2,"ACTION.CANCEL")," "),t.xp6(2),t.Q6J("ngIf",!e.loading.display)}}class we{}const be=[{path:"",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sms-action"]],decls:1,vars:0,template:function(e,n){1&e&&t._UZ(0,"router-outlet")},directives:[E.lC],encapsulation:2}),o})(),children:[{path:"send-message",component:(()=>{class o{constructor(e,n,i,s,l,d){var u;this.coreEnumService=e,this.smsMainApiPathService=n,this.cmsToastrService=i,this.cdr=s,this.publicHelper=l,this.translate=d,this.requestLinkApiPathId="",this.loading=new x.O,this.loadingAction=new x.O,this.dataModelParentSelected=new c.lWT,this.dataModel=new c.sh1,this.dataModelResult=new c.y$4,this.dataModelDateByClock=new we,this.formInfo=new c.LEF,this.clipboardText="",this.cronOptions={includeMinutes:!0,includeHours:!0,includeDates:!0,includeMonths:!0,includeDays:!0,includeMinutesBetween:!0,includeHoursBetween:!0,includeDaysBetween:!0,includeMonthsBetween:!0,includeDatesBetween:!0,showHints:!0,defaultCron:"0 0 1 1 *",flexDirection:"row"},this.otherSettings=["includeMinutes","includeHours","includeDates","includeMonths","includeDays","showHints"],this.betweenSettings=["includeMinutesBetween","includeHoursBetween","includeDatesBetween","includeMonthsBetween","includeDaysBetween"],this.dataMessageCategoryModel=new c._fd,this.dataMessageContentModel=new c.Lnx,this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information"),this.loadingAction.cdr=this.cdr,(null===(u=this.requestLinkApiPathId)||void 0===u?void 0:u.length)>0&&(this.dataModel.linkApiPathId=this.requestLinkApiPathId)}ngOnInit(){this.onActionScheduleSendNow()}setCron(e){this.hourlyCron=e.cron}updateSetting(e,n){this.cronOptions[n]=e.checked}showCron(e){this.dataModel.scheduleCron=e.cronValue}onActionScheduleSendNow(){const e=new Date;this.dataModel.scheduleSend=e,this.dataModelDateByClock.clock=e.getHours()+":"+e.getMinutes(),this.dataModelDateByClock.date=e}onActionScheduleSendCheck(){const e=new Date;this.dataModelDateByClock.clock||(this.dataModelDateByClock.clock=e.getHours()+":"+e.getMinutes()),this.dataModelDateByClock.date||(this.dataModelDateByClock.date=e),this.dataModelDateByClock.date=new Date(this.dataModelDateByClock.date),this.dataModelDateByClock.date.setHours(0|+this.dataModelDateByClock.clock.split(":")[0],0|+this.dataModelDateByClock.clock.split(":")[1]),this.dataModel.scheduleSend=this.dataModelDateByClock.date}readClipboardFromDevTools(){return new Promise((e,n)=>{const i=function(){var s=(0,F.Z)(function*(){try{const l=yield navigator.clipboard.readText();e(l)}catch(l){n(l)}window.removeEventListener("focus",i)});return function(){return s.apply(this,arguments)}}();window.addEventListener("focus",i),console.log("Hit <Tab> to give focus back to document (or we will face a DOMException);")})}onActionSelectPrivateSiteConfig(e){this.dataModel.linkApiPathId=this.requestLinkApiPathId,this.dataModelParentSelected=e,e&&e.id.length>0&&(this.dataModel.linkApiPathId=e.id)}onActionSelectMessageCategory(e){this.dataMessageCategoryModel=e&&e.id.length>0?e:new c._fd}onActionSelectMessageContent(e){this.dataMessageContentModel=e&&e.id.length>0?e:new c.Lnx}onActionSelectApiNumber(e){e&&e.id.length>0&&(this.dataModel.linkFromNumber=e.id)}onActionMessageContentAdd(){var e,n;(null===(n=null===(e=this.dataMessageContentModel)||void 0===e?void 0:e.messageBody)||void 0===n?void 0:n.length)>0?this.dataModel.message.length>0&&(this.dataModel.message=this.dataModel.message+" "+this.dataMessageContentModel.messageBody):this.dataModel.message=this.dataMessageContentModel.messageBody}onActionMessageContentNew(){var e,n;(null===(n=null===(e=this.dataMessageContentModel)||void 0===e?void 0:e.messageBody)||void 0===n?void 0:n.length)>0&&(this.dataModel.message=this.dataMessageContentModel.messageBody)}onFormSubmit(){if(!this.formGroup.valid)return;(!this.dataModel.linkApiPathId||this.dataModel.linkApiPathId.length<=0)&&this.cmsToastrService.typeErrorFormInvalid(),this.onActionScheduleSendCheck(),this.formInfo.formSubmitAllow=!1;const e=this.constructor.name+"main";this.loadingAction.Start(e),this.smsMainApiPathService.ServiceSendMessage(this.dataModel).subscribe({next:n=>{this.formInfo.formSubmitAllow=!0,this.dataModelResult=n,n.isSuccess?(this.formInfo.formAlert="\u062f\u0631\u062e\u0648\u0627\u0633\u062a \u0627\u0631\u0633\u0627\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u062b\u0628\u062a \u0634\u062f",this.cmsToastrService.typeSuccessMessage(this.translate.instant("MESSAGE.Send_request_was_successfully_registered"))):(this.formInfo.formAlert=this.translate.instant("ERRORMESSAGE.MESSAGE.typeError"),this.formInfo.formError=n.errorMessage,this.cmsToastrService.typeErrorMessage(n.errorMessage)),this.loadingAction.Stop(e)},error:n=>{this.formInfo.formSubmitAllow=!0,this.cmsToastrService.typeError(n),this.loadingAction.Stop(e)},complete:()=>{}})}onFormCancel(){}onActionContactCategorySelectChecked(e){if(!e||e.length<=0){const n=this.translate.instant("MESSAGE.category_of_information_is_not_clear");this.cmsToastrService.typeErrorSelected(n)}else this.dataModel.toContactCategories||(this.dataModel.toContactCategories=[]),this.dataModel.toContactContents||(this.dataModel.toContactContents=[]),this.publicHelper.listAddIfNotExist(this.dataModel.toContactCategories,e,0),(this.dataModel.toContactCategories.length>0||this.dataModel.toContactContents.length>0)&&(this.dataModel.toNumbers="")}onActionContactCategorySelectDisChecked(e){if(!e||e.length<=0){const n=this.translate.instant("MESSAGE.category_of_information_is_not_clear");this.cmsToastrService.typeErrorSelected(n)}else this.dataModel.toContactCategories||(this.dataModel.toContactCategories=[]),this.dataModel.toContactContents||(this.dataModel.toContactContents=[]),this.publicHelper.listRemoveIfExist(this.dataModel.toContactCategories,e),(this.dataModel.toContactCategories.length>0||this.dataModel.toContactContents.length>0)&&(this.dataModel.toNumbers="")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(c.FLW),t.Y36(c.sZP),t.Y36(k.e),t.Y36(t.sBO),t.Y36(W.i),t.Y36(Z.sK))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sms-action-send-message"]],viewQuery:function(e,n){if(1&e&&(t.Gf(pe,5),t.Gf(ge,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.formGroup=i.first),t.iGM(i=t.CRH())&&(n.defaultCronInput=i.first)}},decls:78,vars:37,consts:[[3,"ngSubmit"],["vform","ngForm"],[1,"ntk-cms-html-card-header"],[1,"ntk-cms-html-card-body"],[3,"options"],[1,"row"],[1,"col-6"],["mat-stretch-tabs","",1,"example-stretched-tabs","mat-elevation-z4"],["label","\u0645\u0633\u06cc\u0631"],[3,"loading","optionSelectForce","optionPlaceholder","optionSelectFirstItem","optionChange"],[3,"loading","optionSelectForce","optionLinkApiPathId","optionPlaceholder","optionSelectFirstItem","optionChange",4,"ngIf"],["label","\u067e\u06cc\u0627\u0645 \u0647\u0627"],[3,"optionChange"],[3,"optionLinkCategryId","optionChange"],["matInput","","name","dataMessageContentModel.messageBody","type","text","rows","10",3,"ngModel","ngModelChange",4,"ngIf"],["type","button","class","btn btn-light",3,"click",4,"ngIf"],["label","\u0645\u062e\u0627\u0637\u0628"],[3,"optionSelectChecked","optionSelectDisChecked"],["label","\u0632\u0645\u0627\u0646 \u0627\u0631\u0633\u0627\u0644"],[1,"ntk-full-width"],["matInput","","name","scheduleSendDate",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["matSuffix","",3,"for"],["touchUi","",3,"closed"],["scheduleSendDate",""],["matTooltip","\u0632\u0645\u0627\u0646 \u0627\u0631\u0633\u0627\u0644 \u067e\u06cc\u0627\u0645","matSuffix",""],["matInput","","name","scheduleSendClock",3,"ngxTimepicker","ngModel","format","ngModelChange"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["scheduleSendClock",""],[3,"cronOptions","cronEvent"],[2,"direction","ltr"],["label","\u062a\u0646\u0638\u06cc\u0645\u0627\u062a"],["name","dataModel.isFlash",3,"ngModel","ngModelChange"],["name","dataModel.sendByQeue",3,"ngModel","ngModelChange"],[1,"col-3"],["matInput","","name","dataModel.message","type","text","placeholder","...","minlength","1","maxlength","500","rows","5",3,"ngModel","ngModelChange"],["Message",""],["matSuffix",""],[2,"text-align","left"],[4,"ngIf"],["class","ntk-full-width",4,"ngIf"],[3,"dataModel","optionMethod",4,"ngIf"],[1,"ntk-cms-html-card-message"],[1,"form-actions"],[1,"form-text","text-muted"],[1,"form-text","text-muted","danger"],[1,"ntk-cms-html-card-footer"],["class","form-actions",4,"ngIf"],[3,"loading","optionSelectForce","optionLinkApiPathId","optionPlaceholder","optionSelectFirstItem","optionChange"],["matInput","","name","dataMessageContentModel.messageBody","type","text","rows","10",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-light",3,"click"],[1,"ft-x"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["matInput","","name","dataModel.toNumbers","type","text","placeholder","0912","rows","5",3,"ngModel","ngModelChange"],["ToNumbers",""],[2,"text-align","right"],["matSuffix","",1,"info-field-icon"],[1,"info-field-text"],[3,"dataModel","optionMethod"],["type","submit","class","btn btn-success",3,"disabled","click",4,"ngIf"],["type","submit",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-check-square-o"]],template:function(e,n){if(1&e&&(t.TgZ(0,"form",0,1),t.NdJ("ngSubmit",function(){return n.onFormSubmit()}),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3),t._UZ(5,"app-progress-spinner",4),t.TgZ(6,"div",5)(7,"div",6)(8,"mat-tab-group",7)(9,"mat-tab",8)(10,"app-sms-apipath-selector",9),t.NdJ("optionChange",function(s){return n.onActionSelectPrivateSiteConfig(s)}),t.qZA(),t.YNc(11,he,1,4,"app-sms-api-number-selector",10),t.qZA(),t.TgZ(12,"mat-tab",11)(13,"app-sms-main-message-category-selector",12),t.NdJ("optionChange",function(s){return n.onActionSelectMessageCategory(s)}),t.qZA(),t.TgZ(14,"app-sms-main-message-content-selector",13),t.NdJ("optionChange",function(s){return n.onActionSelectMessageContent(s)}),t.qZA(),t.YNc(15,_e,1,1,"textarea",14),t.YNc(16,fe,3,0,"button",15),t.YNc(17,Ce,3,0,"button",15),t.qZA(),t.TgZ(18,"mat-tab",16)(19,"app-cms-contact-category-tree-selector",17),t.NdJ("optionSelectChecked",function(s){return n.onActionContactCategorySelectChecked(s)})("optionSelectDisChecked",function(s){return n.onActionContactCategorySelectDisChecked(s)}),t.qZA()(),t.TgZ(20,"mat-tab",18)(21,"mat-form-field",19)(22,"mat-label"),t._uU(23,"\u062a\u0627\u0631\u06cc\u062e \u0627\u0631\u0633\u0627\u0644"),t.qZA(),t.TgZ(24,"input",20),t.NdJ("ngModelChange",function(s){return n.dataModelDateByClock.date=s}),t.qZA(),t.YNc(25,Me,2,0,"mat-icon",21),t._UZ(26,"mat-datepicker-toggle",22),t.TgZ(27,"mat-datepicker",23,24),t.NdJ("closed",function(){return n.onActionScheduleSendCheck()}),t.qZA(),t.TgZ(29,"mat-icon",25),t._uU(30,"info"),t.qZA()(),t.TgZ(31,"mat-form-field",19)(32,"mat-label"),t._uU(33,"\u0633\u0627\u0639\u062a \u0627\u0631\u0633\u0627\u0644"),t.qZA(),t.TgZ(34,"input",26),t.NdJ("ngModelChange",function(s){return n.dataModelDateByClock.clock=s}),t.qZA(),t.TgZ(35,"mat-icon",27),t.NdJ("click",function(){return n.onActionMessageContentNew()}),t._uU(36," close"),t.qZA(),t._UZ(37,"ngx-material-timepicker-toggle",22),t.TgZ(38,"ngx-material-timepicker",23,28),t.NdJ("closed",function(){return n.onActionScheduleSendCheck()}),t.qZA()(),t._uU(40),t.ALo(41,"persianDateFull"),t._UZ(42,"hr"),t._uU(43),t.TgZ(44,"mat-cron-editor",29),t.NdJ("cronEvent",function(s){return n.showCron(s)}),t.qZA(),t._UZ(45,"br"),t.TgZ(46,"h2",30),t._uU(47),t.qZA()(),t.TgZ(48,"mat-tab",31)(49,"div",19)(50,"mat-slide-toggle",32),t.NdJ("ngModelChange",function(s){return n.dataModel.isFlash=s}),t._uU(51," \u0627\u0631\u0633\u0627\u0644 \u0628\u0647 \u0635\u0648\u0631\u062a \u0641\u0644\u0634 "),t.qZA()(),t.TgZ(52,"div",19)(53,"mat-slide-toggle",33),t.NdJ("ngModelChange",function(s){return n.dataModel.sendByQeue=s}),t._uU(54," \u0627\u0631\u0633\u0627\u0644 \u062f\u0631 \u0635\u0641 "),t.qZA()()()()(),t.TgZ(55,"div",34)(56,"mat-form-field",19)(57,"mat-label"),t._uU(58,"\u0645\u062a\u0646 \u067e\u06cc\u0627\u0645"),t.qZA(),t.TgZ(59,"textarea",35,36),t.NdJ("ngModelChange",function(s){return n.dataModel.message=s}),t.qZA(),t.YNc(61,Se,2,0,"mat-icon",21),t.TgZ(62,"mat-icon",37),t._uU(63,"mode_edit"),t.qZA(),t.TgZ(64,"mat-hint",38),t._uU(65),t.qZA(),t.YNc(66,Ae,5,3,"mat-error",39),t.qZA(),t.YNc(67,Te,15,3,"mat-form-field",40),t.qZA()(),t.YNc(68,ve,1,2,"app-cms-json-list",41),t.qZA(),t.TgZ(69,"div",42)(70,"div",43)(71,"small",44),t._uU(72),t.qZA(),t.TgZ(73,"small",45),t._uU(74),t.qZA()()(),t.TgZ(75,"div",46),t._UZ(76,"app-progress-spinner",4),t.YNc(77,Ze,6,4,"div",47),t.qZA()()),2&e){const i=t.MAs(28),s=t.MAs(39),l=t.MAs(60);t.xp6(3),t.hij(" ",n.formInfo.formTitle," "),t.xp6(2),t.Q6J("options",n.loading),t.xp6(5),t.Q6J("loading",n.loading)("optionSelectForce",n.dataModel.linkApiPathId)("optionPlaceholder"," \u0645\u0633\u06cc\u0631")("optionSelectFirstItem",!0),t.xp6(1),t.Q6J("ngIf",(null==n.dataModel.linkApiPathId?null:n.dataModel.linkApiPathId.length)>0),t.xp6(3),t.Q6J("optionLinkCategryId",n.dataMessageCategoryModel.id),t.xp6(1),t.Q6J("ngIf",(null==n.dataMessageContentModel||null==n.dataMessageContentModel.messageBody?null:n.dataMessageContentModel.messageBody.length)>0),t.xp6(1),t.Q6J("ngIf",(null==n.dataMessageContentModel||null==n.dataMessageContentModel.messageBody?null:n.dataMessageContentModel.messageBody.length)>0&&(null==n.dataModel.message?null:n.dataModel.message.length)>0),t.xp6(1),t.Q6J("ngIf",(null==n.dataMessageContentModel||null==n.dataMessageContentModel.messageBody?null:n.dataMessageContentModel.messageBody.length)>0),t.xp6(7),t.Q6J("matDatepicker",i)("ngModel",n.dataModelDateByClock.date),t.xp6(1),t.Q6J("ngIf",i),t.xp6(1),t.Q6J("for",i),t.xp6(8),t.Q6J("ngxTimepicker",s)("ngModel",n.dataModelDateByClock.clock)("format",24),t.xp6(3),t.Q6J("for",s),t.xp6(3),t.hij(" ",t.lcZ(41,35,n.dataModel.scheduleSend)," "),t.xp6(3),t.hij(" ",n.dataModel.scheduleSend," "),t.xp6(1),t.Q6J("cronOptions",n.cronOptions),t.xp6(3),t.hij("Resulting Cron: ",n.dataModel.scheduleCron,""),t.xp6(3),t.Q6J("ngModel",n.dataModel.isFlash),t.xp6(3),t.Q6J("ngModel",n.dataModel.sendByQeue),t.xp6(6),t.Q6J("ngModel",n.dataModel.message),t.xp6(2),t.Q6J("ngIf",n.dataModel.message),t.xp6(4),t.hij("",l.value.length," / 500"),t.xp6(1),t.Q6J("ngIf",null==l.errors?null:l.errors.required),t.xp6(1),t.Q6J("ngIf",!(n.dataModel.toContactCategories&&0!=(null==n.dataModel.toContactCategories?null:n.dataModel.toContactCategories.length)||n.dataModel.toContactContents&&0!=(null==n.dataModel.toContactContents?null:n.dataModel.toContactContents.length))),t.xp6(1),t.Q6J("ngIf",null==n.dataModelResult?null:n.dataModelResult.item),t.xp6(4),t.hij("",n.formInfo.formAlert," "),t.xp6(2),t.hij("",n.formInfo.formError," "),t.xp6(2),t.Q6J("options",n.loadingAction),t.xp6(1),t.Q6J("ngIf",n.formInfo.formSubmitAllow&&!n.loading.display)}},directives:[m._Y,m.JL,m.F,X.O,O.SP,O.uX,K.s,M.O5,z.y,tt.b,rt,D.Nt,m.Fj,m.JJ,m.On,_t,f.KE,f.hX,I.hl,w.Hw,f.R9,I.nW,I.Mq,ft.gM,b.I2,b.u_,b.ro,re,de.Rr,m.wO,m.nD,f.bx,f.TO,ue.v],pipes:[me.K,Z.X$],styles:[".form-body[_ngcontent-%COMP%]{width:500px}@media (max-width: 700px){.form-body[_ngcontent-%COMP%]{display:contents}}#file-manager[_ngcontent-%COMP%]{width:calc(100vw - 16px);height:calc(100vh - 16px)}.recordStatus-1.mat-select-panel[_ngcontent-%COMP%]{background:yellow}.recordStatus-2.mat-select-panel[_ngcontent-%COMP%]{background:black}.recordStatus-3.mat-select-panel[_ngcontent-%COMP%]{background:red}.mat-tab-group[_ngcontent-%COMP%]{height:95%}"]}),o})()}]}];let Ee=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[E.Bz.forChild(be)],E.Bz]}),o})();var ke=r(2489),Ne=r(8601),Ie=r(6720),Je=r(3914),Fe=r(5103),Oe=r(4586);let Ue=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[c.EAm,c.FLW,c.Z8z,Je.s,c.dF2,c.sZP,c.buc,c.GrT],imports:[[M.ez,Oe.SmsMainModule,Ee,m.u5,m.UX.withConfig({warnOnNgModelWithFormControl:"never"}),ke.m.forRoot(),Ne.UM,b.rK,ce,w.Ps,f.lN,Ie.T5,Fe.r]]}),o})()}}]);