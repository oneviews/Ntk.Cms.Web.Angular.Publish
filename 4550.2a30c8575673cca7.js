"use strict";(self.webpackChunkntk_cms_web=self.webpackChunkntk_cms_web||[]).push([[4550],{6609:(K,v,s)=>{s.d(v,{D:()=>n});var a=s(8239),e=s(9724),c=s(7977),m=s(1659),A=s(1927),D=s(3151),T=s(2147),E=s(1528),M=s(7969),O=s(656),d=s(4817),f=s(5691),P=s(8904),C=s(5821),g=s(1048),I=s(1531),S=s(4848),y=s(1418);function R(o,l){if(1&o&&(e._UZ(0,"img",8),e.ALo(1,"cmsthumbnail")),2&o){const t=e.oxw().$implicit;e.s9C("src",e.lcZ(1,1,t.linkImageIdSrc),e.LSH)}}function L(o,l){if(1&o&&(e.TgZ(0,"mat-option",6),e.YNc(1,R,2,3,"img",7),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&o){const t=l.$implicit,i=e.oxw();e.Q6J("value",t)("disabled",i.optionDisabled),e.xp6(1),e.Q6J("ngIf",t.linkImageIdSrc),e.xp6(2),e.Oqu(i.displayOption(t))}}function p(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"mat-icon",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().onActionSelectClear()}),e._uU(1,"close"),e.qZA()}}const u=["*"];let n=(()=>{class o{constructor(t,i,_,h){this.coreEnumService=t,this.translate=i,this.cdr=_,this.categoryService=h,this.id=++o.nextId,this.dataModelResult=new c.y$4,this.dataModelSelect=new c.Dp$,this.loading=new O.O,this.formControl=new m.NI,this.optionDisabled=!1,this.optionSelectFirstItem=!1,this.optionPlaceholder="",this.optionChange=new e.vpe,this.optionReload=()=>this.onActionReload(),this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information")}set optionSelectForce(t){this.onActionSelectForce(t)}ngOnInit(){this.loadOptions()}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe((0,A.O)(""),(0,D.b)(1500),(0,T.x)(),(0,E.w)(t=>this.DataGetAll("string"==typeof t||"number"==typeof t?t:"")))}displayFn(t){return t&&t.virtual_Parent&&t.virtual_Parent.title.length>0?t.virtual_Parent.titleML+" > "+t.titleML:t?t.titleML:void 0}displayOption(t){return t&&t.virtual_Parent&&t.virtual_Parent.title.length>0?t.virtual_Parent.titleML+" > "+t.titleML:t?t.titleML:void 0}DataGetAll(t){var i=this;return(0,a.Z)(function*(){const _=new c.Hay;if(_.rowPerPage=20,_.accessLoad=!0,t&&t.length>0){let r=new c.AO3;r=new c.AO3,r.propertyName="Symbol",r.value=t,r.searchType=c.b3P.Contains,r.clauseType=c.KT6.Or,_.filters.push(r),r=new c.AO3,r.propertyName="Title",r.value=t,r.searchType=c.b3P.Contains,r.clauseType=c.KT6.Or,_.filters.push(r),t&&"number"==typeof+t&&+t>0&&(r=new c.AO3,r.propertyName="Id",r.value=t,r.searchType=c.b3P.Equal,r.clauseType=c.KT6.Or,_.filters.push(r))}const h=i.constructor.name+"main";return i.loading.Start(h),yield i.categoryService.ServiceGetAll(_).pipe((0,M.U)(r=>(i.dataModelResult=r,i.optionSelectFirstItem&&(!i.dataModelSelect||!i.dataModelSelect.id||i.dataModelSelect.id<=0)&&i.dataModelResult.listItems.length>0&&(i.optionSelectFirstItem=!1,setTimeout(()=>{i.formControl.setValue(i.dataModelResult.listItems[0])},1e3),i.onActionSelect(i.dataModelResult.listItems[0])),i.loading.Stop(h),r.listItems))).toPromise()})()}onActionSelect(t){this.optionDisabled||(this.dataModelSelect=t,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.formControl.setValue(null),this.optionChange.emit(null))}push(t){return this.filteredOptions.pipe((0,M.U)(i=>(i.find(_=>_.id===t.id)||i.push(t),i)))}onActionSelectForce(t){if("number"==typeof t&&t>0){if(this.dataModelSelect&&this.dataModelSelect.id===t)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===t)){const i=this.dataModelResult.listItems.find(_=>_.id===t);return this.dataModelSelect=i,void this.formControl.setValue(i)}this.categoryService.ServiceGetOneById(t).subscribe(i=>{i.isSuccess&&(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item))})}else{if(typeof t==typeof c.Dp$)return this.filteredOptions=this.push(t),this.dataModelSelect=t,void this.formControl.setValue(t);this.formControl.setValue(null)}}onActionReload(){this.dataModelSelect=new c.Dp$,this.loadOptions()}}return o.nextId=0,o.\u0275fac=function(t){return new(t||o)(e.Y36(c.FLW),e.Y36(d.sK),e.Y36(e.sBO),e.Y36(c.XRW))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-cms-location-selector"]],inputs:{loading:"loading",optionDisabled:"optionDisabled",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionReload:"optionReload",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},ngContentSelectors:u,decls:8,vars:9,consts:[[1,"ntk-full-width"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto34","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[3,"value","disabled"],["style","vertical-align:middle;","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(t,i){if(1&t&&(e.F$t(),e.TgZ(0,"mat-form-field",0),e._UZ(1,"input",1),e.TgZ(2,"mat-autocomplete",2,3),e.NdJ("optionSelected",function(h){return i.onActionSelect(h.option.value)}),e.YNc(4,L,4,4,"mat-option",4),e.ALo(5,"async"),e.qZA(),e.YNc(6,p,2,0,"mat-icon",5),e.Hsn(7),e.qZA()),2&t){const _=e.MAs(3);e.xp6(1),e.s9C("placeholder",i.optionPlaceholder),e.Q6J("formControl",i.formControl)("matAutocomplete",_),e.uIk("disabled",!!i.optionDisabled||null),e.xp6(1),e.Q6J("displayWith",i.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(5,7,i.filteredOptions)),e.xp6(2),e.Q6J("ngIf",i.dataModelSelect.id)}},directives:[f.KE,P.Nt,m.Fj,C.ZL,m.JJ,m.oH,C.XC,g.sg,I.ey,g.O5,S.Hw,f.R9],pipes:[g.Ov,y.v],encapsulation:2}),o})()},9831:(K,v,s)=>{s.d(v,{u:()=>L});var a=s(9724),e=s(7977),c=s(4482),m=s(1659),A=s(1927),D=s(3151),T=s(1528),E=s(7969),M=s(2607),O=s(5691),d=s(6405),f=s(1048),P=s(4848),C=s(5821),g=s(1531);const I=["tagInput"];function S(p,u){if(1&p){const n=a.EpF();a.TgZ(0,"mat-chip",9),a.NdJ("removed",function(){const t=a.CHM(n).$implicit;return a.oxw().remove(t)}),a._uU(1),a.TgZ(2,"button",10)(3,"mat-icon"),a._uU(4,"cancel"),a.qZA()()()}if(2&p){const n=u.$implicit;a.xp6(1),a.hij(" ",n.display," ")}}function y(p,u){if(1&p&&(a.TgZ(0,"mat-option",11),a._uU(1),a.qZA()),2&p){const n=u.$implicit;a.Q6J("value",n),a.xp6(1),a.hij(" ",n.display," ")}}let L=(()=>{class p{constructor(n,o){this.service=n,this.cmsToastrService=o,this.id=++p.nextId,this.optionDisabled=!1,this.optionPlaceholder="+ Tag",this.optionLabel=" Select",this.optionChange=new a.vpe,this.tagDataModel=[],this.tagLastDataModel=[],this.selectForceStatus=!0,this.separatorKeysCodes=[c.K5],this.tagCtrl=new m.NI(""),this.addOnBlur=!0,this.filteredOptions=this.tagCtrl.valueChanges.pipe((0,A.O)(null),(0,D.b)(400),(0,T.w)(l=>this.filter(l||"")))}set optionSelectForce(n){this.onActionSelectForce(n)}ngOnInit(){}filter(n){const o=new e.Hay;o.rowPerPage=20,o.accessLoad=!0;let l=new e.AO3;return l.propertyName="Title",l.value=n,l.searchType=e.b3P.Contains,l.clauseType=e.KT6.Or,o.filters.push(l),n&&"number"==typeof+n&&+n>0&&(l=new e.AO3,l.propertyName="Id",l.value=n,l.searchType=e.b3P.Equal,l.clauseType=e.KT6.Or,o.filters.push(l)),this.service.ServiceGetAll(o).pipe((0,E.U)(t=>(this.tagLastDataModel=t.listItems.map(i=>({display:i.title,value:i.id})),this.tagLastDataModel)))}checkIndex(n){var o=0,l=-1;return this.tagDataModel.forEach(t=>{t.value==n&&(l=o),o++}),l}add(n){var o;n.value&&this.tagLastDataModel.forEach(l=>{(l.display==n.value||l.value+""==n.value)&&(o=l)}),o&&this.checkIndex(o.value)<0&&(this.tagDataModel.push(o),this.onActionChange()),n.chipInput.clear(),this.tagCtrl.setValue(null)}remove(n){const o=this.checkIndex(n.value);o>=0&&(this.tagDataModel.splice(o,1),this.onActionChange())}selected(n){const o=n.option.value;this.checkIndex(o.value)<0&&this.tagDataModel.push(o),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null),this.onActionChange()}onActionChange(){const n=[];this.tagDataModel.forEach(o=>{n.push(o.value)}),this.selectForceStatus=!1,this.optionChange.emit(n)}onActionSelectForce(n){if(!this.selectForceStatus||!n||0===n.length)return;const o=new e.Hay;n.forEach(l=>{if(l>0){const t=new e.AO3;t.propertyName="Id",t.value=l,t.clauseType=e.KT6.Or,o.filters.push(t)}}),this.service.ServiceGetAll(o).pipe((0,E.U)(l=>{l.isSuccess?l.listItems.forEach(t=>{this.tagDataModel.push({value:t.id,display:t.title})}):this.cmsToastrService.typeErrorGetAll(l.errorMessage)},l=>{this.cmsToastrService.typeErrorGetAll(l)})).toPromise()}}return p.nextId=0,p.\u0275fac=function(n){return new(n||p)(a.Y36(e.dF2),a.Y36(M.e))},p.\u0275cmp=a.Xpm({type:p,selectors:[["app-cms-tag-autocomplete"]],viewQuery:function(n,o){if(1&n&&a.Gf(I,5),2&n){let l;a.iGM(l=a.CRH())&&(o.tagInput=l.first)}},inputs:{optionDisabled:"optionDisabled",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},decls:12,vars:12,consts:[["appearance","fill",2,"width","100%"],["aria-label","tag selection",3,"disabled"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],[3,"placeholder","matChipInputAddOnBlur","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(n,o){if(1&n&&(a.TgZ(0,"mat-form-field",0)(1,"mat-label"),a._uU(2),a.qZA(),a.TgZ(3,"mat-chip-list",1,2),a.YNc(5,S,5,1,"mat-chip",3),a.TgZ(6,"input",4,5),a.NdJ("matChipInputTokenEnd",function(t){return o.add(t)}),a.qZA()(),a.TgZ(8,"mat-autocomplete",6,7),a.NdJ("optionSelected",function(t){return o.selected(t)}),a.YNc(10,y,2,2,"mat-option",8),a.ALo(11,"async"),a.qZA()()),2&n){const l=a.MAs(4),t=a.MAs(9);a.xp6(2),a.Oqu(o.optionLabel),a.xp6(1),a.Q6J("disabled",o.optionDisabled),a.xp6(2),a.Q6J("ngForOf",o.tagDataModel),a.xp6(1),a.Q6J("placeholder",o.optionPlaceholder)("matChipInputAddOnBlur",o.addOnBlur)("formControl",o.tagCtrl)("matAutocomplete",t)("matChipInputFor",l)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes),a.xp6(4),a.Q6J("ngForOf",a.lcZ(11,10,o.filteredOptions))}},directives:[O.KE,O.hX,d.qn,f.sg,d.HS,d.qH,P.Hw,m.Fj,C.ZL,d.oH,m.JJ,m.oH,C.XC,g.ey],pipes:[f.Ov],encapsulation:2}),p})()}}]);