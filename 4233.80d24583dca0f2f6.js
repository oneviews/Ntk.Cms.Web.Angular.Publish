"use strict";(self.webpackChunkntk_cms_web=self.webpackChunkntk_cms_web||[]).push([[4233],{4233:(At,x,l)=>{l.r(x),l.d(x,{SmsActionModule:()=>St});var g=l(1048),b=l(7076),v=l(8239),a=l(7977),C=l(656),t=l(9724),T=l(2607),O=l(3029),A=l(4817),d=l(1659),w=l(5738),N=l(4311),y=l(1927),P=l(3151),Z=l(2147),I=l(1528),_=l(7969),m=l(5691),F=l(8904),k=l(5821),J=l(1531),M=l(4848);function U(i,r){if(1&i&&(t.TgZ(0,"mat-option",8)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=r.$implicit,o=t.oxw();t.Q6J("value",e)("disabled",o.optionDisabled),t.xp6(2),t.Oqu(o.displayPathOption(e))}}function R(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-icon",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().onActionSelectClearPath()}),t._uU(1,"close"),t.qZA()}}function D(i,r){if(1&i&&(t.TgZ(0,"mat-option",8)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=r.$implicit,o=t.oxw();t.Q6J("value",e)("disabled",o.optionDisabled),t.xp6(2),t.Oqu(o.displayNumberOption(e))}}function Q(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-icon",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().onActionSelectClearNumber()}),t._uU(1,"close"),t.qZA()}}const E=["*","*"];let G=(()=>{class i{constructor(e,o,n,s,c,f){this.coreEnumService=e,this.cmsToastrService=o,this.cdr=n,this.translate=s,this.pathService=c,this.numberService=f,this.dataPathModelResult=new a.y$4,this.dataNumberModelResult=new a.y$4,this.dataPathModelSelect=new a.lWT,this.dataNumberModelSelect=new a.FEG,this.loading=new C.O,this.formPathControl=new d.NI,this.formNumberControl=new d.NI,this.optionDisabled=!1,this.optionSelectFirstItem=!1,this.optionPlaceholder="",this.optionPathChange=new t.vpe,this.optionNumberChange=new t.vpe,this.optionReload=()=>this.onActionReload(),this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information")}set optionSelectPathForce(e){this.onActionSelectPathForce(e)}set optionSelectNumberForce(e){this.onActionSelectNumberForce(e)}ngOnInit(){this.loadOptions()}loadOptions(){this.filteredPathOptions=this.formPathControl.valueChanges.pipe((0,y.O)(""),(0,P.b)(1e3),(0,Z.x)(),(0,I.w)(e=>"string"==typeof e?this.DataPathGetAll(e||""):[])),this.filteredNumberOptions=this.formNumberControl.valueChanges.pipe((0,y.O)(""),(0,P.b)(1e3),(0,Z.x)(),(0,I.w)(e=>"string"==typeof e?this.DataNumberGetAll(e||""):[]))}displayPathFn(e){return e?e.title:void 0}displayNumberFn(e){return e?e.numberChar:void 0}displayPathOption(e){return e?e.title:void 0}displayNumberOption(e){return e?e.numberChar:void 0}DataPathGetAll(e){var o=this;return(0,v.Z)(function*(){const n=new a.Hay;n.rowPerPage=20,n.accessLoad=!0;let s=new a.AO3;return s.propertyName="Title",s.value=e,s.searchType=a.b3P.Contains,s.clauseType=a.KT6.Or,n.filters.push(s),e&&"number"==typeof+e&&+e>0&&(s=new a.AO3,s.propertyName="Id",s.value=e,s.searchType=a.b3P.Equal,s.clauseType=a.KT6.Or,n.filters.push(s)),o.loading.Start("DataPathGetAll"),yield o.pathService.ServiceGetAll(n).pipe((0,_.U)(c=>(o.dataPathModelResult=c,o.optionSelectFirstItem&&(!o.dataPathModelSelect||!o.dataPathModelSelect.id||o.dataPathModelSelect.id.length<=0)&&o.dataPathModelResult.listItems.length>0&&(o.optionSelectFirstItem=!1,setTimeout(()=>{o.formPathControl.setValue(o.dataPathModelResult.listItems[0])},1e3),o.onActionSelectPath(o.dataPathModelResult.listItems[0])),o.loading.Stop("DataPathGetAll"),c.listItems))).toPromise()})()}DataNumberGetAll(e){var o=this;return(0,v.Z)(function*(){const n=new a.Hay;n.rowPerPage=20,n.accessLoad=!0;let s=new a.AO3;return s.propertyName="Title",s.value=e,s.searchType=a.b3P.Contains,s.clauseType=a.KT6.Or,n.filters.push(s),e&&"number"==typeof+e&&+e>0&&(s=new a.AO3,s.propertyName="Id",s.value=e,s.searchType=a.b3P.Equal,s.clauseType=a.KT6.Or,n.filters.push(s)),o.loading.Start("DataNumberGetAll"),yield o.numberService.ServiceGetAll(n).pipe((0,_.U)(c=>(o.dataNumberModelResult=c,o.optionSelectFirstItem&&(!o.dataNumberModelSelect||!o.dataNumberModelSelect.id||o.dataNumberModelSelect.id.length<=0)&&o.dataNumberModelResult.listItems.length>0&&(o.optionSelectFirstItem=!1,setTimeout(()=>{o.formNumberControl.setValue(o.dataNumberModelResult.listItems[0])},1e3),o.onActionSelectNumber(o.dataNumberModelResult.listItems[0])),o.loading.Stop("DataNumberGetAll"),c.listItems))).toPromise()})()}onActionSelectPath(e){this.optionDisabled||(this.dataPathModelSelect=e,this.optionPathChange.emit(this.dataPathModelSelect))}onActionSelectNumber(e){this.optionDisabled||(this.dataNumberModelSelect=e,this.optionNumberChange.emit(this.dataNumberModelSelect))}onActionSelectClearPath(){this.optionDisabled||(this.formPathControl.setValue(null),this.optionPathChange.emit(null))}onActionSelectClearNumber(){this.optionDisabled||(this.formNumberControl.setValue(null),this.optionNumberChange.emit(null))}pushPath(e){return this.filteredPathOptions.pipe((0,_.U)(o=>(o.find(n=>n.id===e.id)||o.push(e),o)))}pushNumber(e){return this.filteredNumberOptions.pipe((0,_.U)(o=>(o.find(n=>n.id===e.id)||o.push(e),o)))}onActionSelectPathForce(e){if("string"==typeof e&&e.length>0){if(this.dataPathModelSelect&&this.dataPathModelSelect.id===e)return;if(this.dataPathModelResult&&this.dataPathModelResult.listItems&&this.dataPathModelResult.listItems.find(o=>o.id===e)){const o=this.dataPathModelResult.listItems.find(n=>n.id===e);return this.dataPathModelSelect=o,void this.formPathControl.setValue(o)}this.pathService.ServiceGetOneById(e).subscribe({next:o=>{o.isSuccess?(this.filteredPathOptions=this.pushPath(o.item),this.dataPathModelSelect=o.item,this.formPathControl.setValue(o.item),this.optionPathChange.emit(o.item)):this.cmsToastrService.typeErrorMessage(o.errorMessage)}})}else{if(typeof e==typeof a.lWT)return this.filteredPathOptions=this.pushPath(e),this.dataPathModelSelect=e,void this.formPathControl.setValue(e);this.formPathControl.setValue(null)}}onActionSelectNumberForce(e){if("string"==typeof e&&e.length>0){if(this.dataNumberModelSelect&&this.dataNumberModelSelect.id===e)return;if(this.dataNumberModelResult&&this.dataNumberModelResult.listItems&&this.dataNumberModelResult.listItems.find(o=>o.id===e)){const o=this.dataNumberModelResult.listItems.find(n=>n.id===e);return this.dataNumberModelSelect=o,void this.formNumberControl.setValue(o)}this.numberService.ServiceGetOneById(e).subscribe({next:o=>{o.isSuccess?(this.filteredNumberOptions=this.pushNumber(o.item),this.dataNumberModelSelect=o.item,this.formNumberControl.setValue(o.item),this.optionNumberChange.emit(o.item)):this.cmsToastrService.typeErrorMessage(o.errorMessage)}})}else{if(typeof e==typeof a.FEG)return this.filteredNumberOptions=this.pushNumber(e),this.dataNumberModelSelect=e,void this.formNumberControl.setValue(e);this.formNumberControl.setValue(null)}}onActionReload(){this.dataPathModelSelect=new a.lWT,this.dataNumberModelSelect=new a.FEG,this.DataPathGetAll(null)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(a.FLW),t.Y36(T.e),t.Y36(t.sBO),t.Y36(A.sK),t.Y36(a.sZP),t.Y36(a.cPv))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-sms-action-send-message-api"]],inputs:{loading:"loading",optionDisabled:"optionDisabled",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionReload:"optionReload",optionSelectPathForce:"optionSelectPathForce",optionSelectNumberForce:"optionSelectNumberForce"},outputs:{optionPathChange:"optionPathChange",optionNumberChange:"optionNumberChange"},ngContentSelectors:E,decls:16,vars:16,consts:[[1,"ntk-full-width"],["type","text","placeholder","\u0645\u0633\u06cc\u0631 \u0627\u0631\u0633\u0627\u0644","aria-label","Assignee","matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto17","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["type","text","placeholder","\u0634\u0645\u0627\u0631\u0647","aria-label","Assignee","matInput","",3,"formControl","matAutocomplete"],["auto18","matAutocomplete"],[3,"value","disabled"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(e,o){if(1&e&&(t.F$t(E),t.TgZ(0,"mat-form-field",0),t._UZ(1,"input",1),t.TgZ(2,"mat-autocomplete",2,3),t.NdJ("optionSelected",function(s){return o.onActionSelectPath(s.option.value)}),t.YNc(4,U,3,3,"mat-option",4),t.ALo(5,"async"),t.qZA(),t.YNc(6,R,2,0,"mat-icon",5),t.Hsn(7),t.qZA(),t.TgZ(8,"mat-form-field",0),t._UZ(9,"input",6),t.TgZ(10,"mat-autocomplete",2,7),t.NdJ("optionSelected",function(s){return o.onActionSelectNumber(s.option.value)}),t.YNc(12,D,3,3,"mat-option",4),t.ALo(13,"async"),t.qZA(),t.YNc(14,Q,2,0,"mat-icon",5),t.Hsn(15,1),t.qZA()),2&e){const n=t.MAs(3),s=t.MAs(11);t.xp6(1),t.Q6J("formControl",o.formPathControl)("matAutocomplete",n),t.uIk("disabled",!!o.optionDisabled||null),t.xp6(1),t.Q6J("displayWith",o.displayPathFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(5,12,o.filteredPathOptions)),t.xp6(2),t.Q6J("ngIf",o.dataPathModelSelect.id),t.xp6(3),t.Q6J("formControl",o.formNumberControl)("matAutocomplete",s),t.uIk("disabled",!!o.optionDisabled||null),t.xp6(1),t.Q6J("displayWith",o.displayNumberFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(13,14,o.filteredNumberOptions)),t.xp6(2),t.Q6J("ngIf",o.dataNumberModelSelect.id)}},directives:[m.KE,F.Nt,d.Fj,k.ZL,d.JJ,d.oH,k.XC,g.sg,J.ey,g.O5,M.Hw,m.R9],pipes:[g.Ov],encapsulation:2}),i})();var Y=l(4405),h=l(4187),H=l(9252),L=l(8485),q=l(727),j=l(3472),W=l(6088);function V(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-tree-node",6),t._UZ(1,"button",7),t.TgZ(2,"mat-checkbox",8),t.NdJ("change",function(){const s=t.CHM(e).$implicit;return t.oxw().checklistSelection.toggle(s)}),t._uU(3),t.qZA()()}if(2&i){const e=r.$implicit,o=t.oxw();t.xp6(2),t.Q6J("checked",o.checklistSelection.isSelected(e)),t.xp6(1),t.Oqu(e.title)}}function $(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-nested-tree-node")(1,"li")(2,"div",9)(3,"button",10)(4,"mat-icon",11),t._uU(5),t.qZA()(),t.TgZ(6,"mat-checkbox",12),t.NdJ("change",function(){const s=t.CHM(e).$implicit;return t.oxw().todoItemSelectionToggle(s)}),t._uU(7),t.qZA()(),t.TgZ(8,"ul"),t.GkF(9,13),t.qZA()()()}if(2&i){const e=r.$implicit,o=t.oxw();t.xp6(3),t.uIk("aria-label","Toggle "+e.title),t.xp6(2),t.hij(" ",o.treeControl.isExpanded(e)?"expand_more":"chevron_right"," "),t.xp6(1),t.Q6J("checked",o.checklistSelection.isSelected(e))("indeterminate",o.descendantsPartiallySelected(e)),t.xp6(1),t.hij(" ",e.title,""),t.xp6(1),t.ekj("category-tree-invisible",!o.treeControl.isExpanded(e))}}let B=(()=>{class i{constructor(e,o,n,s,c,f,Ct){this.cmsToastrService=e,this.coreEnumService=o,this.categoryService=n,this.cdr=s,this.dialog=c,this.translate=f,this.tokenHelper=Ct,this.dataModelSelect=[],this.dataModelResult=new a.y$4,this.filteModel=new a.Hay,this.loading=new C.O,this.treeControl=new Y.VY(u=>u.children),this.dataSource=new h.WX,this.runComplate=!1,this.optionSelectChecked=new t.vpe,this.optionSelectDisChecked=new t.vpe,this.optionModelChange=new t.vpe,this.checklistSelection=new H.Ov(!0),this.hasChild=(u,p)=>!!p.children&&p.children.length>0,this.hasNoContent=(u,p)=>p.children,this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information"),this.checklistSelection.changed.subscribe(u=>{if(!this.runComplate)return;const p=[];this.checklistSelection.selected.forEach(S=>{p.push(S.id)}),this.optionModelChange.emit(p),u.added&&u.added.length>0&&u.added.forEach(S=>{this.optionSelectChecked.emit(S.id)}),u.removed&&u.removed.length>0&&u.removed.forEach(S=>{this.optionSelectDisChecked.emit(S.id)})})}set optionModel(e){this.dataModelSelect=e,this.loadCheked()}ngOnInit(){this.DataGetAll(),this.cmsApiStoreSubscribe=this.tokenHelper.getCurrentTokenOnChange().subscribe(e=>{this.DataGetAll()})}ngOnDestroy(){this.cmsApiStoreSubscribe.unsubscribe()}loadCheked(e=this.treeControl.dataNodes){this.runComplate=!1,this.treeControl.dataNodes&&this.dataModelSelect&&this.dataModelSelect.length>0&&e.forEach(o=>{this.dataModelSelect.find(s=>s===o.id)&&this.checklistSelection.select(o),o.children&&o.children.length>0&&this.loadCheked(o.children)}),this.runComplate=!0}DataGetAll(){this.filteModel.rowPerPage=200,this.filteModel.accessLoad=!0;const e=this.constructor.name+"main";this.loading.Start(e),this.categoryService.ServiceGetAll(this.filteModel).subscribe({next:o=>{o.isSuccess?(this.dataModelResult=o,this.dataSource.data=this.dataModelResult.listItems,this.treeControl.dataNodes=this.dataModelResult.listItems,this.loadCheked()):this.cmsToastrService.typeErrorMessage(o.errorMessage),this.loading.Stop(e)},error:o=>{this.loading.Stop(e),this.cmsToastrService.typeError(o)}})}descendantsAllSelected(e){return this.treeControl.getDescendants(e).every(n=>this.checklistSelection.isSelected(n))}descendantsPartiallySelected(e){return this.treeControl.getDescendants(e).some(s=>this.checklistSelection.isSelected(s))&&!this.descendantsAllSelected(e)}todoItemSelectionToggle(e){this.checklistSelection.toggle(e);const o=this.treeControl.getDescendants(e);this.checklistSelection.isSelected(e)?this.checklistSelection.select(...o):this.checklistSelection.deselect(...o)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.e),t.Y36(a.FLW),t.Y36(a.buc),t.Y36(t.sBO),t.Y36(L.uw),t.Y36(A.sK),t.Y36(q.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-cms-contact-category-tree-selector"]],inputs:{optionModel:"optionModel"},outputs:{optionSelectChecked:"optionSelectChecked",optionSelectDisChecked:"optionSelectDisChecked",optionModelChange:"optionModelChange"},decls:6,vars:3,consts:[[1,"ntk-cms-html-tree-header"],[1,"ntk-cms-html-tree-body"],[1,"category-tree","cursor-pointer",3,"dataSource","treeControl"],["matTreeNodePadding","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"ntk-cms-html-tree-footer"],["matTreeNodePadding",""],["type","button","mat-icon-button","","disabled",""],[1,"checklist-leaf-node",3,"checked","change"],[1,"mat-tree-node"],["type","button","mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],[3,"checked","indeterminate","change"],["matTreeNodeOutlet",""]],template:function(e,o){1&e&&(t._UZ(0,"div",0),t.TgZ(1,"div",1)(2,"mat-tree",2),t.YNc(3,V,4,2,"mat-tree-node",3),t.YNc(4,$,10,7,"mat-nested-tree-node",4),t.qZA()(),t._UZ(5,"div",5)),2&e&&(t.xp6(2),t.Q6J("dataSource",o.dataSource)("treeControl",o.treeControl),t.xp6(2),t.Q6J("matTreeNodeDefWhen",o.hasChild))},directives:[h.gi,h.fQ,h.uo,h.ah,j.lW,W.oG,h.GZ,h.eu,M.Hw,h.Ar],encapsulation:2}),i})();var X=l(8024),K=l(8161),z=l(1582),tt=l(2370);const et=["vform"];function ot(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"app-sms-api-number-selector",40),t.NdJ("optionChange",function(n){return t.CHM(e),t.oxw(2).onActionSelectApiNumber(n)}),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("loading",e.loading)("optionLinkApiPathId",e.dataModel.linkApiPathId)("optionPlaceholder"," \u0634\u0645\u0627\u0631\u0647 \u0641\u0631\u0633\u062a\u0646\u062f\u0647")}}function nt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-icon",41),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).dataModel.message=""}),t._uU(1,"close"),t.qZA()}}function it(i,r){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," \u0645\u062a\u0646 \u067e\u06cc\u0627\u0645 "),t.TgZ(2,"strong"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"MESSAGE.required")))}function st(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-icon",41),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).dataModel.toNumber=""}),t._uU(1,"close"),t.qZA()}}function at(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14)(2,"mat-tab-group",15)(3,"mat-tab",16),t._UZ(4,"textarea",17),t._uU(5," \u0645\u062a\u0646 \u0627\u0631\u0633\u0627\u0644 "),t.qZA(),t.TgZ(6,"mat-tab",18),t._UZ(7,"app-sms-action-send-message-api"),t.qZA(),t.TgZ(8,"mat-tab",19)(9,"app-cms-contact-category-tree-selector",20),t.NdJ("optionSelectChecked",function(n){return t.CHM(e),t.oxw().onActionContactSelectChecked(n)})("optionSelectDisChecked",function(n){return t.CHM(e),t.oxw().onActionContactSelectDisChecked(n)}),t.qZA()(),t.TgZ(10,"mat-tab",21),t._uU(11," \u0632\u0645\u0627\u0646 \u0627\u0631\u0633\u0627\u0644 "),t.qZA(),t.TgZ(12,"mat-tab",22),t._uU(13," \u062a\u0646\u0638\u06cc\u0645\u0627\u062a "),t.qZA()()(),t.TgZ(14,"div",23)(15,"app-sms-apipath-selector",24),t.NdJ("optionChange",function(n){return t.CHM(e),t.oxw().onActionSelectPrivateSiteConfig(n)}),t.qZA(),t.YNc(16,ot,1,3,"app-sms-api-number-selector",25),t.TgZ(17,"mat-form-field",26)(18,"mat-label"),t._uU(19,"\u0645\u062a\u0646 \u067e\u06cc\u0627\u0645"),t.qZA(),t.TgZ(20,"textarea",27,28),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().dataModel.message=n}),t.qZA(),t.YNc(22,nt,2,0,"mat-icon",29),t.TgZ(23,"mat-icon",30),t._uU(24,"mode_edit"),t.qZA(),t.TgZ(25,"mat-hint",31),t._uU(26),t.qZA(),t.YNc(27,it,5,3,"mat-error",32),t.qZA(),t.TgZ(28,"mat-form-field",26)(29,"mat-label"),t._uU(30,"\u0634\u0645\u0627\u0631\u0647 \u06af\u06cc\u0631\u0646\u062f\u0647"),t.qZA(),t.TgZ(31,"textarea",33,34),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().dataModel.toNumber=n}),t.qZA(),t.YNc(33,st,2,0,"mat-icon",29),t.TgZ(34,"mat-icon",30),t._uU(35,"mode_edit"),t.qZA(),t.TgZ(36,"mat-hint",35)(37,"mat-icon",36),t._uU(38,"info"),t.qZA(),t.TgZ(39,"strong",37),t._uU(40,"\u0634\u0645\u0627\u0631\u0647 \u06af\u06cc\u0631\u0646\u062f\u0647 \u067e\u06cc\u0627\u0645 \u0631\u0627 \u0645\u06cc \u062a\u0648\u0627\u0646\u06cc\u062f \u0628\u0627 \u06a9\u0627\u0645\u0627 \u0627\u0632 \u0647\u0645 \u062c\u062f\u0627 \u06a9\u0646\u06cc\u062f"),t.qZA()(),t.TgZ(41,"mat-hint",31),t._uU(42),t.qZA()(),t.TgZ(43,"div",26)(44,"mat-slide-toggle",38),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().dataModel.isFlash=n}),t._uU(45," \u0627\u0631\u0633\u0627\u0644 \u0628\u0647 \u0635\u0648\u0631\u062a \u0641\u0644\u0634 "),t.qZA()(),t.TgZ(46,"div",26)(47,"mat-slide-toggle",39),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().dataModel.sendByQeue=n}),t._uU(48," \u0627\u0631\u0633\u0627\u0644 \u062f\u0631 \u0635\u0641 "),t.qZA()()()()}if(2&i){const e=t.MAs(21),o=t.MAs(32),n=t.oxw();t.xp6(4),t.Q6J("ngModel",n.clipboardText),t.xp6(11),t.Q6J("loading",n.loading)("optionSelectForce",n.dataModel.linkApiPathId)("optionPlaceholder"," \u0645\u0633\u06cc\u0631"),t.xp6(1),t.Q6J("ngIf",(null==n.dataModel.linkApiPathId?null:n.dataModel.linkApiPathId.length)>0),t.xp6(4),t.Q6J("ngModel",n.dataModel.message),t.xp6(2),t.Q6J("ngIf",n.dataModel.message),t.xp6(4),t.hij("",e.value.length," / 500"),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(4),t.Q6J("ngModel",n.dataModel.toNumber),t.xp6(2),t.Q6J("ngIf",n.dataModel.toNumber),t.xp6(9),t.hij("",o.value.length," / 50"),t.xp6(2),t.Q6J("ngModel",n.dataModel.isFlash),t.xp6(3),t.Q6J("ngModel",n.dataModel.sendByQeue)}}function lt(i,r){if(1&i&&t._UZ(0,"app-cms-json-list",42),2&i){const e=t.oxw();t.Q6J("dataModel",e.dataModelResult.item)("optionMethod",1)}}function rt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onFormSubmit()}),t._UZ(1,"i",47),t._uU(2),t.ALo(3,"translate"),t.qZA()}if(2&i){t.oxw(2);const e=t.MAs(1);t.Q6J("disabled",!e.valid),t.xp6(2),t.hij(" ",t.lcZ(3,2,"ACTION.Send_Message")," ")}}function ct(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",8)(1,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw().onFormCancel()}),t._UZ(2,"i",44),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,rt,4,4,"button",45),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,2,"ACTION.CANCEL")," "),t.xp6(2),t.Q6J("ngIf",!e.loading.display)}}const dt=[{path:"",component:(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-sms-action"]],decls:1,vars:0,template:function(e,o){1&e&&t._UZ(0,"router-outlet")},directives:[b.lC],encapsulation:2}),i})(),children:[{path:"send-message",component:(()=>{class i{constructor(e,o,n,s,c,f){this.coreEnumService=e,this.smsMainApiPathService=o,this.cmsToastrService=n,this.cdr=s,this.publicHelper=c,this.translate=f,this.requestLinkApiPathId="",this.loading=new C.O,this.loadingAction=new C.O,this.dataModelParentSelected=new a.lWT,this.dataModel=new a.sh1,this.dataModelResult=new a.y$4,this.formInfo=new a.LEF,this.clipboardText="",this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information"),this.loadingAction.cdr=this.cdr}ngOnInit(){var e;(null===(e=this.requestLinkApiPathId)||void 0===e?void 0:e.length)>0&&(this.dataModel.linkApiPathId=this.requestLinkApiPathId),this.readClipboardFromDevTools().then(o=>this.clipboardText=o)}readClipboardFromDevTools(){return new Promise((e,o)=>{const n=function(){var s=(0,v.Z)(function*(){try{const c=yield navigator.clipboard.readText();console.log(`${c} is read!`),e(c)}catch(c){o(c)}window.removeEventListener("focus",n)});return function(){return s.apply(this,arguments)}}();window.addEventListener("focus",n),console.log("Hit <Tab> to give focus back to document (or we will face a DOMException);")})}onActionSelectPrivateSiteConfig(e){this.dataModel.linkApiPathId=this.requestLinkApiPathId,this.dataModelParentSelected=e,e&&e.id.length>0&&(this.dataModel.linkApiPathId=e.id)}onActionSelectApiNumber(e){e&&e.id.length>0&&(this.dataModel.linkFromNumber=e.id)}onFormSubmit(){if(!this.formGroup.valid)return;(!this.dataModel.linkApiPathId||this.dataModel.linkApiPathId.length<=0)&&this.cmsToastrService.typeErrorFormInvalid(),this.formInfo.formSubmitAllow=!1;const e=this.constructor.name+"main";this.loadingAction.Start(e),this.smsMainApiPathService.ServiceSendMessage(this.dataModel).subscribe({next:o=>{this.formInfo.formSubmitAllow=!0,this.dataModelResult=o,o.isSuccess?(this.formInfo.formAlert="\u062f\u0631\u062e\u0648\u0627\u0633\u062a \u0627\u0631\u0633\u0627\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u062b\u0628\u062a \u0634\u062f",this.cmsToastrService.typeSuccessMessage(this.translate.instant("MESSAGE.Send_request_was_successfully_registered"))):(this.formInfo.formAlert=this.translate.instant("ERRORMESSAGE.MESSAGE.typeError"),this.formInfo.formError=o.errorMessage,this.cmsToastrService.typeErrorMessage(o.errorMessage)),this.loadingAction.Stop(e)},error:o=>{this.formInfo.formSubmitAllow=!0,this.cmsToastrService.typeError(o),this.loadingAction.Stop(e)},complete:()=>{}})}onFormCancel(){}onActionContactSelectChecked(e){if(!e||e<=0){const o=this.translate.instant("MESSAGE.category_of_information_is_not_clear");this.cmsToastrService.typeErrorSelected(o)}}onActionContactSelectDisChecked(e){if(!e||e<=0){const o=this.translate.instant("MESSAGE.category_of_information_is_not_clear");this.cmsToastrService.typeErrorSelected(o)}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(a.FLW),t.Y36(a.sZP),t.Y36(T.e),t.Y36(t.sBO),t.Y36(O.i),t.Y36(A.sK))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-sms-action-send-message"]],viewQuery:function(e,o){if(1&e&&t.Gf(et,5),2&e){let n;t.iGM(n=t.CRH())&&(o.formGroup=n.first)}},decls:17,vars:8,consts:[[3,"ngSubmit"],["vform","ngForm"],[1,"ntk-cms-html-card-header"],[1,"ntk-cms-html-card-body"],[3,"options"],["class","row",4,"ngIf"],[3,"dataModel","optionMethod",4,"ngIf"],[1,"ntk-cms-html-card-message"],[1,"form-actions"],[1,"form-text","text-muted"],[1,"form-text","text-muted","danger"],[1,"ntk-cms-html-card-footer"],["class","form-actions",4,"ngIf"],[1,"row"],[1,"col-6"],["mat-stretch-tabs","",1,"example-stretched-tabs","mat-elevation-z4"],["label","\u067e\u06cc\u0627\u0645 \u0627\u0631\u0633\u0627\u0644"],["name","clipboardText","readonly","readonly",3,"ngModel"],["label","\u0645\u0633\u06cc\u0631"],["label","\u0645\u062e\u0627\u0637\u0628"],[3,"optionSelectChecked","optionSelectDisChecked"],["label","\u0632\u0645\u0627\u0646 \u0627\u0631\u0633\u0627\u0644"],["label","\u062a\u0646\u0638\u06cc\u0645\u0627\u062a"],[1,"col-3"],[3,"loading","optionSelectForce","optionPlaceholder","optionChange"],[3,"loading","optionSelectForce","optionLinkApiPathId","optionPlaceholder","optionChange",4,"ngIf"],[1,"ntk-full-width"],["matInput","","name","dataModel.message","type","text","placeholder","...","minlength","1","maxlength","500","rows","5",3,"ngModel","ngModelChange"],["Message",""],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["matSuffix",""],[2,"text-align","left"],[4,"ngIf"],["matInput","","name","dataModel.toNumber","type","text","placeholder","0912","rows","5",3,"ngModel","ngModelChange"],["ToNumber",""],[2,"text-align","right"],["matSuffix","",1,"info-field-icon"],[1,"info-field-text"],["name","dataModel.isFlash",3,"ngModel","ngModelChange"],["name","dataModel.sendByQeue",3,"ngModel","ngModelChange"],[3,"loading","optionSelectForce","optionLinkApiPathId","optionPlaceholder","optionChange"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"dataModel","optionMethod"],["type","button",1,"btn","btn-light",3,"click"],[1,"ft-x"],["type","submit","class","btn btn-success",3,"disabled","click",4,"ngIf"],["type","submit",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-check-square-o"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0,1),t.NdJ("ngSubmit",function(){return o.onFormSubmit()}),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3),t._UZ(5,"app-progress-spinner",4),t.YNc(6,at,49,14,"div",5),t.YNc(7,lt,1,2,"app-cms-json-list",6),t.qZA(),t.TgZ(8,"div",7)(9,"div",8)(10,"small",9),t._uU(11),t.qZA(),t.TgZ(12,"small",10),t._uU(13),t.qZA()()(),t.TgZ(14,"div",11),t._UZ(15,"app-progress-spinner",4),t.YNc(16,ct,6,4,"div",12),t.qZA()()),2&e&&(t.xp6(3),t.hij(" ",o.formInfo.formTitle," "),t.xp6(2),t.Q6J("options",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading.display),t.xp6(1),t.Q6J("ngIf",null==o.dataModelResult?null:o.dataModelResult.item),t.xp6(4),t.hij("",o.formInfo.formAlert," "),t.xp6(2),t.hij("",o.formInfo.formError," "),t.xp6(2),t.Q6J("options",o.loadingAction),t.xp6(1),t.Q6J("ngIf",o.formInfo.formSubmitAllow&&!o.loading.display))},directives:[d._Y,d.JL,d.F,w.O,g.O5,N.SP,N.uX,d.Fj,d.JJ,d.On,G,B,X.s,K.y,m.KE,m.hX,F.Nt,d.wO,d.nD,M.Hw,m.R9,m.bx,m.TO,z.Rr,tt.v],pipes:[A.X$],styles:[".form-body[_ngcontent-%COMP%]{width:500px}@media (max-width: 700px){.form-body[_ngcontent-%COMP%]{display:contents}}#file-manager[_ngcontent-%COMP%]{width:calc(100vw - 16px);height:calc(100vh - 16px)}.recordStatus-1.mat-select-panel[_ngcontent-%COMP%]{background:yellow}.recordStatus-2.mat-select-panel[_ngcontent-%COMP%]{background:black}.recordStatus-3.mat-select-panel[_ngcontent-%COMP%]{background:red}"]}),i})()}]}];let ut=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[b.Bz.forChild(dt)],b.Bz]}),i})();var mt=l(2489),ht=l(8601),pt=l(6720),gt=l(3914),ft=l(5103);let St=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[a.EAm,a.FLW,a.Z8z,gt.s,a.dF2,a.sZP,a.buc,a.GrT],imports:[[g.ez,ut,d.u5,d.UX.withConfig({warnOnNgModelWithFormControl:"never"}),mt.m.forRoot(),ht.UM,M.Ps,m.lN,pt.T5,ft.r]]}),i})()}}]);